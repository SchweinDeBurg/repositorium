<html>

<head>
<title>CPJNPOP3Connection v1.47</title>
<link rel="stylesheet" type="text/css" href="./naughter.css">
</head>

<body>

<h2 align="left"><img src="PJNPOP3.gif" width="40" height="40">CPJNPOP3Connection 
v1.47</h2>
<p>Welcome to <strong>CPJNPOP3Connection</strong>, a freeware MFC class to support 
the POP3 (Post Office Protocol v3) protocol. POP3 for those not familiar with all the internet protocols is 
the protocol used to retrieve internet email. </p>
<table>
	<tr>
		<td><a href="#References">References</a></td>
	</tr>
	<tr>
		<td><a href="#Features">Features</a></td>
	</tr>
	<tr>
		<td><a href="#Usage">Usage</a></td>
	</tr>
	<tr>
		<td><a href="#Copyright">Copyright</a></td>
	</tr>
	<tr>
		<td><a href="#History">History</a></td>
	</tr>
	<tr>
		<td><a href="#APIReference">API Reference</a></td>
	</tr>
	<tr>
		<td><a href="#Enhancements">Planned Enhancements</a></td>
	</tr>
	<tr>
		<td><a href="#Contact">Contacting the Author</a></td>
	</tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="References"></a><strong>References</strong> </h2>
<ul>
	<li>For information about <strong style="font-weight: 400">POP3 (Post Office 
	Protocol v3</strong>) you should 
read <a href="http://www.ietf.org/rfc/rfc1939.txt">RFC 1939</a>.</li>
	<li><a href="http://www.ietf.org/rfc/rfc822.txt">RFC 822</a> and 
	<a href="http://www.ietf.org/rfc/rfc2822.txt">RFC 2822</a> define the ways 
	standard headers are used by SMTP/POP3.</li>
	<li><a href="http://www.ietf.org/rfc/rfc2110.txt">RFC
2110</a> and <a href="http://www.ietf.org/rfc/rfc2557.txt">RFC 2557</a> which covers MHTML 
	(aka HTML Email).</li>
	<li>Base64 encoding which is used in various places in SMTP/POP3 is described in
	<a href="http://www.ietf.org/rfc/rfc1113.txt">RFC 1113</a> and
	<a href="http://www.ietf.org/rfc/rfc1421.txt">RFC 1421</a>. If was 
	eventually referred to as Base64 in
	<a href="http://www.ietf.org/rfc/rfc2045.txt">RFC 2045</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="Features"></a>Features </h2>
<ul>
	<li>Simple and clean C++ interface.</li>
	<li>The interface provided is synchronous which provides an easier programming 
	model than using asynchronous sockets.</li>
	<li>The code does not rely on the MFC socket classes. These classes have a number 
	of shortcomings, one of which causes problems when they are used in NT services.</li>
	<li>The code can be used in a console application without any problems (Again 
	this is not the case for the MFC socket classes).</li>
	<li>A configurable timeout for the connection can be set through the class API.</li>
	<li>Supports APOP as well as clear text authentication.</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="Usage"></a>Usage </h2>
<ul>
	<li>The classes are designed for VC 2005 or later. They will not compile on 
	earlier releases of VC.</li>
	<li>To use the class in your code simply include PJNPOP3.cpp/h, SocMFC.cpp/h and PJNMD5.h in your project and #include 
	PJNPOP3.h in which ever of your modules needs to make calls to the classes. 
	You also need to copy all the IDS_PJNPOP3_* strings from the samples apps 
	&quot;POP3Connection.rc&quot; rc file to your applications rc file (Use drag and drop in the 
	Visual C++ resource editor to speed this up!).</li>
	<li>By default SSL connections are also provided for. This is provided by 
	including OpenSSLMfc.cpp/h in your project also. If you do not want to 
	include this support in CPJNPOP3Connection, then you should define the 
	pre-processor macro &quot;CPJNPOP3_NOSSL&quot; before including PJNPOP3.h. In this 
	case, you do not need to include these two modules in your project.</li>
	<li>The following modules are not included in the CPJNPOP3Connection zip 
	download: SocMFC.cpp/h and OpenSSLMfc.cpp/h and you will need 
	to download separately these separately from
	<a href="http://www.naughter.com/w3mfc.html">www.naughter.com/w3mfc.html</a>. 
	</li>
	<li>Also the PJNMD5.h module is not included in the CPJNPOP3Connection zip 
	download and you will need to download this separately from
	<a href="http://www.naughter.com/smtp.html">www.naughter.com/smtp.html</a>.  
	</li>
	<li>To see the class in action, have a look at the code in InitInstance in the 
	module &quot;main.cpp&quot;.</li>
	<li>Your code will need to include MFC either statically or dynamically.</li>
	<li>You will need to have a functioning Winsock stack installed and correctly 
	initialized prior to calling any functions in CPJNPOP3Connection. Depending 
	on your application, this will involve calling either WSAStartup or AfxSocketInit 
	at start-up of your application.</li>
	<li>You will also need to have afxtempl.h and winsock.h or afxsock.h in your 
	precompiled header. The code will work just as well in a GUI or console app. 
	The code should also work in a multithreaded application, although it has not 
	be explicitly tested in this scenario.</li>
	<li>If you will be using the SSL extensions to the class, then you need to 
	compile the OpenSSL libraries into your app and initialize OpenSSL 
	correctly. See the Linker library settings, CApp::InitInstance and 
	CApp::ExitInstance code for examples on doing this in the sample app 
	provided with the download. For more info on this, please see my blog entry:
	<a href="http://naughter.spaces.live.com/blog/cns!7692E6D72E26EAC!209.entry">
	http://naughter.spaces.live.com/blog/cns!7692E6D72E26EAC!209.entry</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><b><a name="Copyright"></a></b>Copyright</h2>
<ul>
	<li>You are allowed to include the source code in any product (commercial, shareware, 
	freeware or otherwise) when your product is released in binary form.</li>
	<li>You are allowed to modify the source code in any way you want except you 
	cannot modify the copyright details at the top of each module.</li>
	<li>If you want to distribute source code with your application, then you are 
	only allowed to distribute versions released by the author. This is to maintain 
	a single distribution point for the source code.</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="History"></a>History</h2>
<p><strong>V1.0 (18 May 1998)</strong> </p>
<ul>
	<li>Initial public release.</li>
</ul>
<p><strong>V1.1 (28 June 1998)</strong> </p>
<ul>
	<li>Fixed a potential buffer overflow problem in Delete and Retrieve functions 
	when a large message number was specified.</li>
	<li>Improve the ReadResponse code by</li>
	<li>&nbsp;&nbsp;&nbsp; a) passing the readability check onto the socket class 
	and </li>
	<li>&nbsp;&nbsp;&nbsp; b) Sleeping for 100 ms prior to looping around waiting 
	for new response data</li>
	<li>Classes are now fully Unicode compliant. Unicode build configurations are 
	also now included.</li>
	<li>Now supports the TOP POP3 command which can be issued using the GetHeader 
	function.</li>
	<li>Fixed a few typos in the documentation.</li>
</ul>
<p><strong>V1.11 (4 January 1999)</strong> </p>
<ul>
	<li>Minor update to the documentation.</li>
	<li>Now includes VC 5 workspace files as standard.</li>
	<li>Properly Unicode enabled all the code as previously the code exposes an 
	Ascii(LPSTR/LPCSTR) API instead of a TCHAR / CString API.</li>
</ul>
<p><strong>V1.12 (22 February 1999)</strong> </p>
<ul>
	<li>Default timeout for the code when a debug build is built has now been set 
	to 60 seconds.</li>
	<li>Improved the reading of responses back from the server by implementing a 
	growable receive buffer. </li>
	<li>Updated instructions on how the relevant RFC documents can be retrieved.</li>
</ul>
<p><strong>V1.13 (25 March 1999)</strong> </p>
<ul>
	<li>Fixed a memory leak in the CPJNPOP3Connection::ReadReturnResponse function.</li>
	<li>Now sleeps for 250 ms instead of yielding the time slice. This helps reduce 
	CPU usage when waiting for data to arrive in the socket</li>
</ul>
<p><strong>V1.14 (15 June 1999)</strong> </p>
<ul>
	<li>Added functions to return the message body, header or a particular header 
	field of a message.</li>
	<li>Tidied up some of the TRACE messages which the code generates.</li>
	<li>Fixed some typos and spelling mistakes in this file.</li>
</ul>
<p><strong>V1.15 (16 June 1999)</strong> </p>
<ul>
	<li>Fixed a bug in the GetHeaderItem function which was causing a header item 
	which appeared at the beginning of the header fields to fail to be parsed incorrectly.</li>
</ul>
<p><strong>V1.16 (27 June 1999)</strong> </p>
<ul>
	<li>Fixed a bug in the GetHeaderItem function when a header spanned multiple 
	lines as is allowed by RFC 822.</li>
</ul>
<p><strong>V1.17 (29 June 1999)</strong> </p>
<ul>
	<li>Another improvement to GetHeaderItem. When will it end &lt;g&gt;. Originally this 
	was reported as a bug but upon further investigation it turns out that the message 
	which was causing the problems had embedded tabs in the header. This is discouraged 
	by the RFC which refers to mail headers (RFC 822). The code has been enhanced 
	to handle this case. Thanks to Chris Bishop for spotting this.</li>
	<li>Fix for a bug in GetHeaderItem where I accidentally was using &quot;=&quot; instead 
	of &quot;==&quot;. Thanks to Angelini Fabio for spotting this.</li>
	<li>Updated documentation to refer to RFC 822.</li>
</ul>
<p><strong>V1.18 (5 July 1999)</strong> </p>
<ul>
	<li>Addition of the following functions:<br>
	i) CPJNPOP3Message::GetReplyTo()<br>
	ii) CPJNPOP3Message::GetRawBody <br>
	iii) CPJNPOP3Message::GetSubject <br>
	iv) CPJNPOP3Message::GetFrom <br>
	v) CPJNPOP3Message::GetDate </li>
	<li>GetHeaderItem function now uses case insensitive searching.</li>
	<li>GetHeaderItem now allows you to search for the &quot;n&#39;th&quot; header of a specified 
	type.</li>
</ul>
<p><strong>V1.19 (24 August 1999)</strong> </p>
<ul>
	<li>Fixed a bug whereby the function GetHeader was sometimes failing when it 
	was called when the message was retrieved using the &quot;TOP&quot; command.</li>
</ul>
<p><strong>V1.20 (26 March 2000)</strong> </p>
<ul>
	<li>Fixed a problem where GetBody and GetRawBody will fail if you call it for 
	a CPJNPOP3Message object that doesn&#39;t have a message in it (i.e m_pszMessage 
	== NULL). This was previously causing a goof old access violation in GetRawBody.</li>
</ul>
<p><strong>V1.21 (20 September 2000)</strong> </p>
<ul>
	<li>Fixed a bug in CPJNPOP3Connection::UIDL when message id&#39;s were returned 
	with embedded dots in them. Thanks to Konstantin Vasserman for finding and resolving 
	this problem.</li>
</ul>
<p><strong>24 March 2001</strong> </p>
<ul>
	<li>Updated the documentation and copyright info.</li>
</ul>
<p><strong>V1.22 (27 July 2001)</strong> </p>
<ul>
	<li>Added two methods namely: GetTo() and GetCC() to the CPJNPOP3Message class.</li>
</ul>
<p><strong>V1.23 (11 August 2001)</strong> </p>
<ul>
	<li>Fixed a bug in CPJNPOP3Connection::ReadResponse where determining the terminator 
	was failing when an embedded NULL was in the message.</li>
</ul>
<p><strong>V1.24 (27 September 2001)</strong> </p>
<ul>
	<li>Fixed a bug in CPJNPOP3Connection::ReadResponse when handling disconnection 
	errors. Thanks to Yuheng Zhao for spotting this problem.</li>
	<li>Improved the error handling in Delete, GetMessageSize &amp; GetMessageID methods. 
	Thanks to Maxim Y. Melnik for spotting this problem.</li>
</ul>
<p><strong>V1.25 (29 September 2001)</strong> </p>
<ul>
	<li>Further improved the error handling in CPJNPOP3Connection::ReadResponse</li>
</ul>
<p><strong>29 March 2003</strong></p>
<ul>
	<li>Initially I was intending adding file attachment support to the class and 
	numerous people have requested this feature but during my research I came across 
	a much more fully featured C++ encapsulation of MIME that I could possibly implement. 
	The project itself is called Mime++ and the URL is
	<a href="http://www.hunnysoft.com/mimepp/">http://www.hunnysoft.com/mimepp/</a>. 
	The classes provided are nicely implemented in C++ and integrate well with both 
	MFC and my CPJNPOP3Connection classes. This software is commercial. Alternatively 
	you could use CDO for Windows 2000 to parse what is returned by the class. I 
	do not propose to add support for attachments in the future so please no more 
	emails asking for this!!</li>
</ul>
<p><strong>v1.26 (5 July 2003)</strong></p>
<ul>
	<li>Added copy constructors and operator= methods to the CPJNPOP3Message class. 
	Thanks to &quot;Sten&quot; for pointing out this omission.</li>
	<li>Made destructors of all classes virtual.</li>
</ul>
<p><strong>v1.27 (21 July 2003)</strong></p>
<ul>
	<li>Class now preserves last command response across calls to Disconnect. This 
	is especially important in calls to Connect when for example you get the POP3 
	error &quot;-Err. Can&#39;t lock the mailbox&quot; or something like this when you call Connect. 
	Thanks to &quot;Lev Elbert&quot; for reporting this problem and providing the fix.
	</li>
</ul>
<p><strong>v1.28 (3 November 2003)</strong></p>
<ul>
	<li>Simplified the code in CPJNPOP3Connection::ReadResponse. Thanks to Clarke 
	Brunt for reporting this issue.</li>
	<li>Reviewed the various trace statements in the code.</li>
</ul>
<p><strong>v1.29 (6 November 2003)</strong></p>
<ul>
	<li>Fixed a problem with an unitialized &quot;m_pszMessage&quot; in the CPJNPOP3Message 
	constructor. Thanks to Michael Gunlock for reporting this problem.</li>
</ul>
<p><strong>v1.30 (12 November 2003)</strong></p>
<ul>
	<li>Fixed a bug in the CPJNPOP3Message operator= method. Thanks to Henrik Grek 
	for reporting this bug.</li>
</ul>
<p><strong>v1.31 (5 June 2004)</strong></p>
<ul>
	<li>Fixed a bug in CPJNPOP3Connection::ReadResponse, where the wrong parameters 
	were being null terminated. Thanks to &quot;caowen&quot; for this update.</li>
</ul>
<p><strong>v1.32 (4 July 2004)</strong></p>
<ul>
	<li>Added an IsConnected() method to the CPJNPOP3Connection class. Thanks to 
	Alessandro Rosa for this addition.</li>
	<li>Added two new helper functions, namely CPJNPOP3Message::GetEmailAddress 
	and CPJNPOP3Message::GetEmailFriendlyName. Thanks to Alessandro Rosa for this 
	suggestion.</li>
</ul>
<p><strong>v1.33 (9 August 2004)</strong></p>
<ul>
	<li>Fixed a number of compiler warnings when the code is compiled with VC.Net 
	2003</li>
</ul>
<p><strong>v1.34 (28 March 2005)</strong></p>
<ul>
	<li>Fixed a number of compiler warnings in the sample app when the code is compiled 
	with VC .NET 2003.</li>
	<li>Timeout now defaults to 5 seconds in debug mode.</li>
	<li>Added support for connecting via Socks4, Socks5 and HTTP proxies</li>
	<li>Added support for POP3 via SSL. Thanks to Serhiy Pavlov and Alexey Kuznetsov 
	for suggesting this update. Please note that because I do not have access to 
	a mail server which provides POP3 over SSL, you should consider this support 
	preliminary until I get feedback from users of this feature. The standard POP3 
	support is still fully functional and tested of course.</li>
</ul>
<p><strong>v1.35 (9 April 2005)</strong></p>
<ul>
	<li>Updated the initialization code for OpenSSL in the sample app to avoid memory 
	leaks. Thanks to Alexey Kuznetsov for reporting these issues. You should implement 
	the same initialization and cleanup code in your applications. For details please 
	check the code in &quot;main.cpp&quot; module which is enclosed in #ifndef POP3_NOSSL_SUPPORT 
	/ #endif sections.</li>
	<li>&quot;List&quot; function is now public instead of protected. Thanks to Alexey Kuznetsov 
	for reporting these issues. </li>
	<li>Addition of a simple &quot;FindMessageID&quot; which returns the Message index given 
	a message ID as returned via UIDL. Thanks to Alexey Kuznetsov for this addition.
	</li>
</ul>
<p><strong>v1.36 (8 February 2006)</strong></p>
<ul>
	<li>Updated the documentation to use the same style as the web site.</li>
	<li>Removed the unnecessary resource.h from the download zip file.</li>
	<li>Fixed a /Wp64 compile issue in CPJNPOP3Connection::FindMessageID. Thanks 
	to Alexey Kuznetsov for reporting this issue.</li>
	<li>Updated copyright details.</li>
	<li>Renamed the classes to include a PJN prefix inline with my SMTP class.</li>
	<li>Provided a PJNPOP3_EXT_CLASS to allow the class to be easily added to an 
	extension dll </li>
	<li>Did a spell check of this document.</li>
	<li>Changed the pre-processor macro to exclude SSL support to be CPJNPOP3_NOSSL. 
	This is to maintain consistency with my SMTP class. </li>
	<li>Changed the default release mode timeout to 60 seconds and the default debug 
	mode timeout to 90 seconds. This is to maintain consistency with my SMTP class.
	</li>
</ul>
<p><strong>v1.37 (13 February 2006)</strong></p>
<ul>
	<li>Fixed a graceful disconnect issue in CPJNPOP3Connection::ReadResponse.</li>
</ul>
<p><strong>v1.38 (9 July 2006)</strong></p>
<ul>
	<li>Optimized CPJNPOP3Message constructor code.</li>
	<li>Code now uses new C++ style casts rather than old style C casts where necessary.</li>
	<li>Optimized CPJNPOP3Connection constructor code</li>
	<li>All classes now uses exceptions to indicate errors. This means the whole 
	area of handling errors in the code is a whole lot simpler. You should carefully 
	review your code as a lot of the return values from methods (especially CPJNPOP3Connection) 
	are now void and will throw CPJNPOP3Exception&#39;s.</li>
	<li>General rework of the class to bring it in line with the author&#39;s CPJNSMTPConnection 
	code</li>
	<li>Update the code in the sample app to TRACE out what it is doing</li>
	<li>Updated the code to clean compile on VC 2005</li>
</ul>
<p><strong>v1.39 (20 November 2006)</strong></p>
<ul>
	<li>Minor update to the sample app to allow it to clean compile on VC 2005 
	</li>
	<li>Optimized ReadResponse method so that if an error occurs while reading 
	the &quot;RETR&quot; response, only the actual command text is set into 
	m_sLastCommandResponse instead of the whole message. This avoids a great 
	performance hit on Unicode projects because of the m_sLastCommandResponse 
	CString nature (ANSI -&gt; UNICODE conversion). Thanks to Alexey Kuznetsov for 
	reporting this issue.</li>
</ul>
<p><strong>v1.40 (21 July 2007)</strong></p>
<ul>
	<li>Updated copyright details</li>
	<li>CPJNPOP3Connection::Connect, Delete, Statistics, List, UIDL, Reset, Noop 
	and GetMessageHeader methods now catch CWSocketException exceptions and 
	rethrow them as CPJNPOP3Exception exceptions. This allows client code to 
	only expect CPJNPOP3Exception exceptions to be thrown from the class. Thanks 
	to Alexey Kuznetsov for reporting this issue.</li>
</ul>
<p><strong>v1.41 (31 December 2007)</strong></p>
<ul>
	<li>Updated sample app to clean compile on VC 2008</li>
	<li>CPJNPOP3Exception::GetErrorMessage now uses the 
	FORMAT_MESSAGE_IGNORE_INSERTS flag. For more information please see Raymond 
	Chen's blog at
	<a href="http://blogs.msdn.com/oldnewthing/archive/2007/11/28/6564257.aspx">
	http://blogs.msdn.com/oldnewthing/archive/2007/11/28/6564257.aspx</a>. 
	Thanks to Alexey Kuznetsov for reporting this issue.</li>
	<li>CPJNPOP3Exception::GetErrorMessage now uses Checked::tcsncpy_s if 
	compiled using VC 2005 or later.</li>
	<li>Sample app shipped with download is now a VC 2005 solution</li>
</ul>
<p><strong>v1.42 (18 March 2008)</strong></p>
<ul>
	<li>Updated copyright details</li>
	<li>The code now only supports VC 2005 or later.</li>
	<li>Simplified the response parsing considerably through the usage of 
	CStringA</li>
	<li>Fixed logic which terminates the parsing loop in ReadListResponse</li>
	<li>Improved the robustness of the ReadUIDLResponse parsing logic</li>
	<li>Now includes support for APOP authentication. Thanks to &quot;goodsiwen&quot; for 
	prompting this update.</li>
</ul>
<p><strong>v1.43 (18 May 2008)</strong></p>
<ul>
	<li>GetHeaderItem now uses a CStringA parameter instead of CString. Thanks 
	to Alexey Kuznetsov for reporting this issue.</li>
</ul>
<p><strong>v1.44 (31 May 2008)</strong></p>
<ul>
	<li>Code now compiles cleanly using Code Analysis (/analyze)</li>
</ul>
<p><strong>v1.45 (14 June 2008)</strong></p>
<ul>
	<li>Updated code to compile correctly using _ATL_CSTRING_EXPLICIT_CONSTRUCTORS 
	define</li>
</ul>
<p><strong>v1.46 (4 May 2009)</strong></p>
<ul>
	<li>Updated copyright details.</li>
	<li>Updated the sample app's project settings to more modern default values.</li>
	<li>Removed the parsing methods from the CPJNPOP3Message class. For 
	comprehensive support for message parsing please take a look at CDO for 
	Windows 2000.</li>
	<li>Extensively reworked the parsing code to use CByteArray derived classes 
	to hold parsed responses instead of CStringA instances. This handles the 
	unusual but legal situation where a message contains embedded nulls. Thanks 
	to Sergey Lysenko for reporting this issue.</li>
	<li>Fixed a bug in ReadUIDLResponse when parsing the message ID</li>
	<li>The code in Connect now correctly validates that a timestamp has been 
	provided if doing APOP authentication</li>
</ul>
<p><strong>v1.47 (22 December 2009)</strong></p>
<ul>
	<li>Optimized the ReadResponse logic to reduce the amount of searching 
	required to find the terminator in the received buffer. This helps avoid 
	excessive CPU utilization when we receive large responses. Thanks to Alexey 
	Rabets for reporting this issue. </li>
	<li>The size of the read buffer used in the ReadResponse method can now be 
	specified at runtime via SetReadBufferSize().</li>
	<li>Updated the documentation to fix various out of date details in the API 
	reference section.</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="APIReference"></a><strong>API Reference</strong></h2>
<p>The API consists of the public member functions of the class 
CPJNPOP3Connection</p>
<p><a href="#Connect">Connect<br>
</a><a href="#Disconnect">Disconnect<br>
</a><a href="#Statistics">Statistics<br>
</a><a href="#Delete">Delete<br>
</a><a href="#GetMessageSize">GetMessageSize</a><br>
<a href="#GetMessageID">GetMessageID</a><br>
<a href="#Retrieve">Retrieve<br>
</a><a href="#Reset">Reset<br>
</a><a href="#UIDL">UIDL</a><br>
<a href="#GetMessageHeader">GetMessageHeader<br>
</a><a href="#Noop">Noop<br>
</a><a href="#GetLastCommandResponse">GetLastCommandResponse<br>
</a><a href="#GetTimeout">GetTimeout<br>
</a><a href="#SetTimeout">SetTimeout</a><br>
<a href="#GetReadBufferSize">GetReadBufferSize</a><br>
<a href="#SetReadBufferSize">SetReadBufferSize</a><a href="#SetTimeout"><br>
</a></p>
<p>&nbsp;</p>
<p><a name="Connect"></a><strong>CPJNPOP3Connection::Connect</strong></p>
<p><strong>void CPJNPOP3Connection::Connect(LPCTSTR </strong><em>pszHostName</em><strong>, 
LPCTSTR </strong><em>pszUser</em><strong>,&nbsp;&nbsp; LPCTSTR </strong><em>pszPassword</em><strong>, 
int </strong><em>nPort</em><strong> = 110, AuthenticationMethod </strong><em>am</em><strong> 
= AUTH_PLAIN, BOOL </strong><i>bSSL </i><strong>= FALSE);</strong></p>
<p><strong>Parameters</strong></p>
<p><em>pszHostName</em> The network address of the socket to connect to: a machine 
name such as “mail.yourisp.com”, or a dotted number such as “128.56.22.8”.</p>
<p><em>pszUser</em> This is the POP3 user name of the mailbox.</p>
<p><em>pszPassword</em> This is the password for the POP3 mailbox.</p>
<p><em>nPort</em> This is the port number on which to connect. The default value 
is 110 which is the default POP3 port number.</p>
<p>am The authentication method to use. Choices are AUTH_PLAIN which corresponds 
to using the &quot;USER / PASS&quot; commands or AUTH_APOP which uses the APOP challenge / 
response command.</p>
<p>bSSL If compiled to support SSL, then setting this value will cause the 
connection to be made over a SSL connection instead of in the clear.</p>
<p><strong>Remarks</strong></p>
<p>Call this member function to establish a connection to a POP3 mailbox.</p>
<p><strong>See Also</strong></p>
<p><a href="#Disconnect">CPJNPOP3Connection::Disconnect</a></p>
<p>&nbsp;</p>
<p><a name="Disconnect"></a><strong>CPJNPOP3Connection::Disconnect</strong></p>
<p><strong>void CPJNPOP3Connection::Disconnect(BOOL </strong>
<strong style="font-weight: 400; font-style: italic">bGracefully</strong><strong> 
= TRUE);</strong></p>
<p><strong>Parameters</strong></p>
<p><i>bGracefully </i>TRUE if the &quot;QUIT&quot; command should be issued to the POP3 
server before closing the connection.</p>
<p><strong>Remarks</strong></p>
<p>The corollary function of Connect.</p>
<p><strong>See Also</strong></p>
<p><a href="#Connect">CPJNPOP3Connection::Connect</a></p>
<p>&nbsp;</p>
<p><a name="Statistics"></a><strong>CPJNPOP3Connection::Statistics</strong></p>
<p><strong>void CPJNPOP3Connection::Statistics(int&amp; </strong><em>nNumberOfMails</em><strong>, 
int&amp; </strong><em>nTotalMailSize</em><strong>);</strong></p>
<p><strong>Parameters</strong></p>
<p><em>nNumberOfMails</em> Upon a successful return this will contain the number 
of mails waiting in the mailbox.</p>
<p><em>nTotalMailSize</em> Upon a successful return this will contain the size in 
bytes (aka Octets) of all mails waiting in the mailbox.</p>
<p><strong>Remarks</strong></p>
<p>Retrieves the statistics for the Mailbox by issuing the &quot;STAT&quot; command.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetMessageSize">CPJNPOP3Connection::GetMessageSize</a></p>
<p>&nbsp;</p>
<p><a name="Delete"></a><strong>CPJNPOP3Connection::Delete</strong></p>
<p><strong>void CPJNPOP3Connection::Delete(int </strong><em>nMsg</em><strong>);</strong></p>
<p><strong>Parameters</strong></p>
<p><em>nMsg</em> The message number of the message to delete. This value starts 
at 1.</p>
<p><strong>Remarks</strong></p>
<p>Marks a message as &quot;to be deleted&quot; by issuing the &quot;DELE&quot; command.</p>
<p><strong>See Also </strong></p>
<p><a href="#Reset">CPJNPOP3Connection::Reset</a></p>
<p>&nbsp;</p>
<p><a name="GetMessageSize"></a><strong>CPJNPOP3Connection::GetMessageSize</strong></p>
<p><strong>DWORD CPJNPOP3Connection::GetMessageSize(int </strong><em>nMsg</em><strong>);</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">Upon a successful return this will contain the size in bytes 
of the specified message.</p>
<p><strong>Parameters</strong></p>
<p><em>nMsg</em> The message number of the message to retrieve the size of.</p>
<p><strong>Remarks</strong></p>
<p>Retrieves the size of a specified message. Internally this will issue the &quot;LIST&quot; 
command if required.</p>
<p><strong>See Also </strong></p>
<p><a href="#Retrieve">CPJNPOP3Connection::Retrieve</a></p>
<p>&nbsp;</p>
<p><a name="GetMessageID"></a><strong>CPJNPOP3Connection::GetMessageID</strong></p>
<p><strong>CString CPJNPOP3Connection::GetMessageID(int </strong><em>nMsg</em><strong>);</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">Upon a successful return this will contain the ID of the specified 
message as a string.</p>
<p><strong>Parameters</strong></p>
<p><em>nMsg</em> The message number of the message to retrieve the ID of.</p>
<p><strong>Remarks</strong></p>
<p>Retrieves the ID of a specified message. Internally this will issue the &quot;UIDL&quot; 
command if required. As &quot;UIDL&quot; is an optional POP3 command, your client app should 
handle the return value if it is to correctly work on all POP3 servers.</p>
<p><strong>See Also </strong></p>
<p><a href="#UIDL">CPJNPOP3Connection::UIDL</a></p>
<p>&nbsp;</p>
<p><a name="Retrieve"></a><strong>CPJNPOP3Connection::Retrieve</strong></p>
<p><strong>void CPJNPOP3Connection::Retrieve(int </strong><em>nMsg</em><strong>, 
CPJNPOP3Buffer&amp; </strong><em>message</em><strong>);</strong></p>
<p><strong>Parameters</strong></p>
<p><em>nMsg</em> The message number of the message to retrieve the size of.</p>
<p><em>message</em> Upon a successful return this will contain the POP3 messages. 
This class is a simple derivation of the MFC CByteArray class</p>
<p><strong>Remarks</strong></p>
<p>Retrieves the specified message by issuing the &quot;RETR&quot; command.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetMessageSize">CPJNPOP3Connection::GetMessageSize</a></p>
<p>&nbsp;</p>
<p><a name="GetMessageHeader"></a><strong>CPJNPOP3Connection::GetMessageHeader</strong></p>
<p><strong>void CPJNPOP3Connection::GetMessageHeader(int </strong><em>nMsg</em><strong>, 
CPJNPOP3Buffer&amp; </strong><em>message</em><strong>);</strong></p>
<p><strong>Parameters</strong></p>
<p><em>nMsg</em> The message number of the message to retrieve the header of.</p>
<p><em>message</em> Upon a successful return this will contain the POP3 message 
header.</p>
<p><strong>Remarks</strong></p>
<p>Retrieves the header of a specified message. Internally this will issue the &quot;TOP&quot; 
command if required. As &quot;TOP&quot; is an optional POP3 command, your client app should 
handle the return value if it is to correctly work on all POP3 servers.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetMessage">CPJNPOP3Connection::GetMessage</a></p>
<p>&nbsp;</p>
<p><a name="Reset"></a><strong>CPJNPOP3Connection::Reset</strong></p>
<p><strong>void CPJNPOP3Connection::Reset();</strong></p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>Resets all messages which were previously marked as deleted. i.e. it undoes the 
work of all the DELE commands in this session. For further information about how 
messages are deleted in POP3, please refer to the RFC.</p>
<p><strong>See Also </strong></p>
<p><a href="#Delete">CPJNPOP3Connection::Delete</a></p>
<p>&nbsp;</p>
<p><a name="UIDL"></a><strong>CPJNPOP3Connection::UIDL</strong></p>
<p><strong>void CPJNPOP3Connection::UIDL();</strong></p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>Sends the &quot;UIDL&quot; command which retrieves the ID for a specified message. As &quot;UIDL&quot; 
is an optional POP3 command, your client app should handle the return value if it 
is to correctly work on all POP3 servers.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetMessageID">CPJNPOP3Connection::GetMessageID</a></p>
<p>&nbsp;</p>
<p><a name="Noop"></a><strong>CPJNPOP3Connection::Noop</strong></p>
<p><strong>void CPJNPOP3Connection::Noop();</strong></p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>Issues a &quot;NOOP&quot; command to the server.</p>
<p>&nbsp;</p>
<p><a name="GetLastCommandResponse"></a><strong>CPJNPOP3Connection::GetLastCommandResponse</strong></p>
<p><strong>CString CPJNPOP3Connection::GetLastCommandResponse() const;</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">The last command response from the server as a CString.</p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>The CPJNPOP3Connection class can return additional text information along with 
most errors. This extended error information can be retrieved by using the GetLastCommandResponse 
function after an unsuccessful function call. An example of this is if the Connect 
function failed because of a validation problem, GetLastCommandResponse could return 
something like &quot;-ERR Access is denied&quot;. GetLastCommandResponse can be called multiple 
times until another CPJNPOP3Connection function is called which sends a POP3 command.
</p>
<p>&nbsp;</p>
<p><a name="GetTimeout"></a><strong>CPJNPOP3Connection::GetTimeout</strong></p>
<p><strong>DWORD CPJNPOP3Connection::GetTimeout() const;</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">The timeout in milliseconds which the code will wait for responses 
from the POP3 server.</p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>Since CPJNPOP3Connection provides a synchronous API, a timeout mechanism is provided. 
By default the value is 2 seconds in release mode and 20 seconds in debug mode. 
The value is larger in debug mode so that the code does not time out when you are 
debugging it.</p>
<p><strong>See Also </strong></p>
<p><a href="#SetTimeout">CPJNPOP3Connection::SetTimeout</a></p>
<p>&nbsp;</p>
<p><a name="SetTimeout"></a><strong>CPJNPOP3Connection::SetTimeout</strong></p>
<p><strong>void CPJNPOP3Connection::SetTimeout(DWORD </strong><em>dwTimeout</em><strong>)</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">None.</p>
<p><strong>Parameters</strong></p>
<p><em>dwTimeout</em> The new timeout value in milliseconds.</p>
<p><strong>Remarks</strong></p>
<p>Sets the timeout to use for connections to the POP3 server.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetTimeout">CPJNPOP3Connection::GetTimeout</a></p>
<p>&nbsp;</p>
<p><a name="GetReadBufferSize"></a><strong>CPJNPOP3Connection::GetReadBufferSize</strong></p>
<p><strong>DWORD CPJNPOP3Connection::GetReadBufferSize() const;</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">The buffer size to use for receiving responses from the POP3 
server.</p>
<p><strong>Parameters</strong></p>
<p>None.</p>
<p><strong>Remarks</strong></p>
<p>By default this value is 1024 bytes.</p>
<p><strong>See Also </strong></p>
<p><a href="#SetReadBufferSize">CPJNPOP3Connection::SetReadBufferSize</a></p>
<p>&nbsp;</p>
<p><a name="SetReadBufferSize"></a><strong>CPJNPOP3Connection::SetReadBufferSize</strong></p>
<p><strong>void CPJNPOP3Connection::SetReadBufferSize(DWORD </strong><em>dwReadBufferSize</em><strong>) 
const;</strong></p>
<p class="rl"><strong>Return Value</strong></p>
<p class="t">None.</p>
<p><strong>Parameters</strong></p>
<p><em>dwReadBufferSize</em> The buffer size to use in bytes.</p>
<p><strong>Remarks</strong></p>
<p>The corollary function to GetReadBufferSize.</p>
<p><strong>See Also </strong></p>
<p><a href="#GetReadBufferSize">CPJNPOP3Connection::GetReadBufferSize</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="Enhancements"></a>Planned Enhancements</h2>
<ul>
	<li>If you have any other suggested improvements, please let me know so that 
	I can incorporate them into the next release.</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a name="Contact"></a>Contacting the Author</h2>
<p>PJ Naughter<br>
Email: <a href="mailto:pjna@naughter.com">pjna@naughter.com</a><br>
Web: <a href="http://www.naughter.com">http://www.naughter.com</a><br>
22 December 2009</p>

</body>

</html>
