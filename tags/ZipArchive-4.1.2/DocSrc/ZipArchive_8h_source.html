<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ZipArchive.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff" leftmargin="32" marginwidth="32" topmargin="32" marginheight="32">
<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ZipArchive.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ZipArchive_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">// This source file is part of the ZipArchive library source distribution and</span>
<a name="l00003"></a>00003 <span class="comment">// is Copyrighted 2000 - 2012 by Artpol Software - Tadeusz Dracz</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This program is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment">// modify it under the terms of the GNU General Public License</span>
<a name="l00007"></a>00007 <span class="comment">// as published by the Free Software Foundation; either version 2</span>
<a name="l00008"></a>00008 <span class="comment">// of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment">// </span>
<a name="l00010"></a>00010 <span class="comment">// For the licensing details refer to the License.txt file.</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 <span class="comment">// Web Site: http://www.artpol-software.com</span>
<a name="l00014"></a>00014 <span class="comment"></span><span class="comment">// Check the site http://www.artpol-software.com for the updated version of the library.</span>
<a name="l00015"></a>00015 <span class="comment">//   </span>
<a name="l00016"></a>00016 <span class="comment">// The following information files are distributed along with this library:</span>
<a name="l00017"></a>00017 <span class="comment">//  License.txt  - licensing information</span>
<a name="l00018"></a>00018 <span class="comment">//  Appnote.txt  - details on the zip format</span>
<a name="l00019"></a>00019 <span class="comment">//       ( also available at ftp://ftp.pkware.com/appnote.zip)</span>
<a name="l00020"></a>00020 <span class="comment">//</span>
<a name="l00021"></a>00021  
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00030"></a>00030 <span class="preprocessor">#if !defined(ZIPARCHIVE_ZIPARCHIVE_DOT_H)</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define ZIPARCHIVE_ZIPARCHIVE_DOT_H</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#if (_MSC_VER &gt; 1000) &amp;&amp; (defined ZIP_HAS_DLL)</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor"> #pragma warning (push)</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor"> #pragma warning( disable : 4251 ) // needs to have dll-interface to be used by clients of class</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor"> #pragma warning( disable : 4275 ) // non dll-interface class used as base for dll-interface</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;_features.h&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="ZipException_8h.html">ZipException.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;ZipAutoBuffer.h&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="ZipCentralDir_8h.html">ZipCentralDir.h</a>&quot;</span> 
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="ZipStorage_8h.html">ZipStorage.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="ZipPathComponent_8h.html">ZipPathComponent.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;ZipString.h&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;ZipExport.h&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="ZipCryptograph_8h.html">ZipCryptograph.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="FileFilter_8h.html">FileFilter.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="DirEnumerator_8h.html">DirEnumerator.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="ZipCompressor_8h.html">ZipCompressor.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;ZipCallbackProvider.h&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="BitFlag_8h.html">BitFlag.h</a>&quot;</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="preprocessor">#define ZIP_DEFAULT_CODE_PAGE UINT(-1)</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00063"></a><a class="code" href="structCZipAddNewFileInfo.html">00063</a> <span class="keyword">struct </span>ZIP_API <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>
<a name="l00064"></a>00064 {
<a name="l00074"></a><a class="code" href="structCZipAddNewFileInfo.html#acddea5d82dbbe1696714dd2783aeef1b">00074</a>  <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>)
<a name="l00075"></a>00075  {
<a name="l00076"></a>00076   Defaults();
<a name="l00077"></a>00077   m_szFilePath = lpszFilePath;
<a name="l00078"></a>00078   m_bFullPath = bFullPath;
<a name="l00079"></a>00079  }
<a name="l00080"></a>00080 
<a name="l00090"></a><a class="code" href="structCZipAddNewFileInfo.html#a9627213821839603a929eaa9c6ca7d59">00090</a>  <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(LPCTSTR lpszFilePath, LPCTSTR lpszFileNameInZip)
<a name="l00091"></a>00091  {
<a name="l00092"></a>00092   Defaults();
<a name="l00093"></a>00093   m_szFilePath = lpszFilePath;
<a name="l00094"></a>00094   m_szFileNameInZip = lpszFileNameInZip;
<a name="l00095"></a>00095  }
<a name="l00096"></a>00096 
<a name="l00106"></a><a class="code" href="structCZipAddNewFileInfo.html#af8faba175a235a9756953434dd018ad6">00106</a>  <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(CZipAbstractFile* pFile, LPCTSTR lpszFileNameInZip)
<a name="l00107"></a>00107  {
<a name="l00108"></a>00108   Defaults();
<a name="l00109"></a>00109   m_pFile = pFile;
<a name="l00110"></a>00110   m_szFileNameInZip = lpszFileNameInZip;
<a name="l00111"></a>00111  }
<a name="l00112"></a>00112 
<a name="l00123"></a><a class="code" href="structCZipAddNewFileInfo.html#acd656262c3f3f2c454c80b3f28f16d3f">00123</a>  CZipAbstractFile* <a class="code" href="structCZipAddNewFileInfo.html#acd656262c3f3f2c454c80b3f28f16d3f">m_pFile</a>;
<a name="l00124"></a>00124 
<a name="l00130"></a><a class="code" href="structCZipAddNewFileInfo.html#a54e49f36a7dc9e1e6f16651e8e5c44e2">00130</a>  CZipString <a class="code" href="structCZipAddNewFileInfo.html#a54e49f36a7dc9e1e6f16651e8e5c44e2">m_szFilePath</a>;  
<a name="l00131"></a>00131 
<a name="l00137"></a><a class="code" href="structCZipAddNewFileInfo.html#a85d4df19e154636eedd209397c00574d">00137</a>  CZipString <a class="code" href="structCZipAddNewFileInfo.html#a85d4df19e154636eedd209397c00574d">m_szFileNameInZip</a>;
<a name="l00138"></a>00138  
<a name="l00151"></a><a class="code" href="structCZipAddNewFileInfo.html#a5deb0d0300f95c700473170ec9902756">00151</a>  <span class="keywordtype">bool</span> <a class="code" href="structCZipAddNewFileInfo.html#a5deb0d0300f95c700473170ec9902756">m_bFullPath</a>;
<a name="l00152"></a>00152 
<a name="l00157"></a><a class="code" href="structCZipAddNewFileInfo.html#a9a636d5fec970c50215b0a4537539070">00157</a>  <span class="keywordtype">int</span> <a class="code" href="structCZipAddNewFileInfo.html#a9a636d5fec970c50215b0a4537539070">m_iComprLevel</a>;    
<a name="l00158"></a>00158 
<a name="l00163"></a><a class="code" href="structCZipAddNewFileInfo.html#a987a635097bd3c9da5ec206fbe0dffec">00163</a>  <a class="code" href="structZipArchiveLib_1_1CBitFlag.html">ZipArchiveLib::CBitFlag</a> <a class="code" href="structCZipAddNewFileInfo.html#a987a635097bd3c9da5ec206fbe0dffec">m_iSmartLevel</a>;
<a name="l00164"></a>00164 
<a name="l00182"></a><a class="code" href="structCZipAddNewFileInfo.html#a8c754f0148639ec63dab981ea111d662">00182</a>  ZIP_INDEX_TYPE <a class="code" href="structCZipAddNewFileInfo.html#a8c754f0148639ec63dab981ea111d662">m_uReplaceIndex</a>;  
<a name="l00183"></a>00183 
<a name="l00187"></a><a class="code" href="structCZipAddNewFileInfo.html#a90629c2d180ad6c95369e09dda252a5d">00187</a>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structCZipAddNewFileInfo.html#a90629c2d180ad6c95369e09dda252a5d">m_nBufSize</a>;  
<a name="l00188"></a>00188 
<a name="l00193"></a>00193  <span class="keywordtype">void</span> Defaults();
<a name="l00194"></a>00194 };
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 
<a name="l00201"></a><a class="code" href="classCZipArchive.html">00201</a> <span class="keyword">class </span>ZIP_API <a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>  
<a name="l00202"></a>00202 { 
<a name="l00203"></a>00203 <span class="keyword">public</span>:
<a name="l00204"></a>00204  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> m_gszCopyright[];
<a name="l00205"></a>00205  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> m_gszVersion[];
<a name="l00206"></a>00206   
<a name="l00207"></a>00207  <a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>();
<a name="l00208"></a>00208 
<a name="l00209"></a>00209  <span class="keyword">virtual</span> ~<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>();
<a name="l00210"></a>00210  
<a name="l00237"></a>00237  <span class="keywordtype">bool</span> SetPassword(LPCTSTR lpszPassword = NULL, UINT codePage = ZIP_DEFAULT_CODE_PAGE); 
<a name="l00238"></a>00238 
<a name="l00246"></a>00246  CZipString GetPassword()<span class="keyword">const</span> ;
<a name="l00247"></a>00247 
<a name="l00265"></a><a class="code" href="classCZipArchive.html#a4df613845e1f96033e1caa0bd512a988">00265</a>  <span class="keywordtype">bool</span> WillEncryptNextFile()<span class="keyword"> const</span>
<a name="l00266"></a>00266 <span class="keyword"> </span>{
<a name="l00267"></a>00267   <span class="keywordflow">return</span> m_pszPassword.GetSize() != 0 &amp;&amp; m_iEncryptionMethod != <a class="code" href="classCZipCryptograph.html#ab3e0a46c0680f616ccf7a163f4f40332aa72fc2366adc9ba8d011e038717c4f28" title="Indicates no encryption.">CZipCryptograph::encNone</a>;
<a name="l00268"></a>00268  }
<a name="l00269"></a>00269 
<a name="l00295"></a>00295  <span class="keywordtype">bool</span> SetEncryptionMethod(<span class="keywordtype">int</span> iEncryptionMethod = <a class="code" href="classCZipCryptograph.html#ab3e0a46c0680f616ccf7a163f4f40332a3acf6a872aa7b3c932d9e8179ecbeb6a" title="The traditional zip encryption.">CZipCryptograph::encStandard</a>);
<a name="l00296"></a>00296 
<a name="l00308"></a><a class="code" href="classCZipArchive.html#a80a0bdaabef1438ae5ac3140385d3c4a">00308</a>  <span class="keywordtype">int</span> GetEncryptionMethod()<span class="keyword"> const</span>
<a name="l00309"></a>00309 <span class="keyword"> </span>{
<a name="l00310"></a>00310   <span class="keywordflow">return</span> m_iEncryptionMethod;
<a name="l00311"></a>00311  }
<a name="l00312"></a>00312 
<a name="l00341"></a><a class="code" href="classCZipArchive.html#aa83d0131026c8d9a9fb83707a3356ce4">00341</a>  <span class="keywordtype">bool</span> EncryptFile(ZIP_INDEX_TYPE uIndex)
<a name="l00342"></a>00342  {
<a name="l00343"></a>00343   CZipIndexesArray aIndexes;
<a name="l00344"></a>00344   aIndexes.Add(uIndex);
<a name="l00345"></a>00345   <span class="keywordflow">return</span> EncryptFilesInternal(&amp;aIndexes);
<a name="l00346"></a>00346  }
<a name="l00347"></a>00347  
<a name="l00376"></a><a class="code" href="classCZipArchive.html#a491293bc698235d185543301103bd3d2">00376</a>  <span class="keywordtype">bool</span> EncryptFiles(CZipIndexesArray &amp;aIndexes)
<a name="l00377"></a>00377  {
<a name="l00378"></a>00378   <span class="keywordflow">return</span> EncryptFilesInternal(&amp;aIndexes);
<a name="l00379"></a>00379  }
<a name="l00380"></a>00380 
<a name="l00406"></a><a class="code" href="classCZipArchive.html#a6e42b43751eafe1fd87c73043096ae25">00406</a>  <span class="keywordtype">bool</span> EncryptAllFiles()
<a name="l00407"></a>00407  {
<a name="l00408"></a>00408   <span class="keywordflow">return</span> EncryptFilesInternal(NULL);
<a name="l00409"></a>00409  }
<a name="l00410"></a>00410 
<a name="l00436"></a>00436  <span class="keywordtype">bool</span> SetCompressionMethod(WORD uCompressionMethod = <a class="code" href="classCZipCompressor.html#ab68b3b3437bcae944edd4a20ab1ca777a5fd59222ad89ea04a5291654ea63cad5" title="The deflate compression method.">CZipCompressor::methodDeflate</a>);
<a name="l00437"></a>00437 
<a name="l00447"></a><a class="code" href="classCZipArchive.html#a73496c42f9eee22914083fd3bfe3b596">00447</a>  WORD GetCompressionMethod()<span class="keyword"> const</span>
<a name="l00448"></a>00448 <span class="keyword"> </span>{
<a name="l00449"></a>00449   <span class="keywordflow">return</span> m_uCompressionMethod;
<a name="l00450"></a>00450  }
<a name="l00451"></a>00451 
<a name="l00471"></a><a class="code" href="classCZipArchive.html#aaa14ea39420cb30f3ac5bfe0adfea8ad">00471</a>  <span class="keywordtype">void</span> SetCompressionOptions(<a class="code" href="structCZipCompressor_1_1COptions.html">CZipCompressor::COptions</a>* pOptions)
<a name="l00472"></a>00472  {
<a name="l00473"></a>00473   <span class="keywordflow">if</span> (m_iFileOpened)
<a name="l00474"></a>00474   {
<a name="l00475"></a>00475    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : The options will have no effect on the current file processing.\n&quot;</span>);
<a name="l00476"></a>00476   }
<a name="l00477"></a>00477   m_compressorsOptions.Set(pOptions);
<a name="l00478"></a>00478  }
<a name="l00479"></a>00479 
<a name="l00501"></a>00501  <span class="keywordtype">void</span> SetAdvanced(<span class="keywordtype">int</span> iWriteBuffer = 65536, <span class="keywordtype">int</span> iGeneralBuffer = 65536, <span class="keywordtype">int</span> iSearchBuffer = 32768);
<a name="l00502"></a>00502 
<a name="l00503"></a>00503  
<a name="l00516"></a><a class="code" href="classCZipArchive.html#a959036df52c025afe050e22299d1c533">00516</a>  <span class="keywordtype">void</span> GetAdvanced(<span class="keywordtype">int</span>* piWriteBuffer = NULL, <span class="keywordtype">int</span>* piGeneralBuffer = NULL, <span class="keywordtype">int</span>* piSearchBuffer= NULL)
<a name="l00517"></a>00517  {
<a name="l00518"></a>00518   <span class="keywordflow">if</span> (piWriteBuffer)
<a name="l00519"></a>00519    *piWriteBuffer =  m_storage.m_iWriteBufferSize;
<a name="l00520"></a>00520   <span class="keywordflow">if</span> (piGeneralBuffer)
<a name="l00521"></a>00521    *piGeneralBuffer = m_iBufferSize;
<a name="l00522"></a>00522   <span class="keywordflow">if</span> (piSearchBuffer)
<a name="l00523"></a>00523    *piSearchBuffer = m_storage.m_iLocateBufferSize;
<a name="l00524"></a>00524  }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 
<a name="l00547"></a><a class="code" href="classCZipArchive.html#aa5db2354fbabea4a82bb1e242caebf7f">00547</a>  <span class="keywordtype">void</span> SetCallback(<a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback = NULL, <span class="keywordtype">int</span> iWhich = <a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734a87a69af5f658de0921a8c3729ed37ecb">CZipActionCallback::cbAll</a>)
<a name="l00548"></a>00548  {
<a name="l00549"></a>00549   m_callbacks.Set(pCallback, iWhich);
<a name="l00550"></a>00550  }
<a name="l00551"></a>00551 
<a name="l00568"></a><a class="code" href="classCZipArchive.html#a068c632e914649df6986477b85eee0b9">00568</a>  <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* GetCallback(<a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734">CZipActionCallback::CallbackType</a> iWhich)
<a name="l00569"></a>00569  {
<a name="l00570"></a>00570   <span class="keywordflow">return</span> m_callbacks.Get(iWhich);
<a name="l00571"></a>00571  }
<a name="l00572"></a>00572 
<a name="l00579"></a><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9">00579</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9">SegmCallbackType</a>
<a name="l00580"></a>00580  {
<a name="l00581"></a><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a47dca8db71d2aa0205ce47b1d10efe35">00581</a>   scSpan = 0x01,    
<a name="l00582"></a><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a565f74546f3c9eb4aac6e0692817b9db">00582</a>   scSplit = 0x02,    
<a name="l00583"></a><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a1f057a40aadcbf5ca7b4b551ac916ca5">00583</a>   scAll = scSpan | scSplit 
<a name="l00584"></a>00584  };
<a name="l00585"></a>00585 
<a name="l00606"></a>00606  <span class="keywordtype">void</span> SetSegmCallback(<a class="code" href="structCZipSegmCallback.html">CZipSegmCallback</a>* pCallback = NULL, <span class="keywordtype">int</span> callbackType = scSpan);
<a name="l00607"></a>00607 
<a name="l00624"></a><a class="code" href="classCZipArchive.html#a0cab93e835c4d5b3309f5672416f673b">00624</a>  <span class="keywordtype">bool</span> SetSplitNamesHandler(<a class="code" href="classCZipSplitNamesHandler.html">CZipSplitNamesHandler</a>&amp; names)
<a name="l00625"></a>00625  {
<a name="l00626"></a>00626   <span class="keywordflow">return</span> SetSplitNamesHandler(&amp;names, <span class="keyword">false</span>);
<a name="l00627"></a>00627  }
<a name="l00628"></a>00628 
<a name="l00648"></a><a class="code" href="classCZipArchive.html#a35f9982583097cbbf23892e46196060e">00648</a>  <span class="keywordtype">bool</span> SetSplitNamesHandler(<a class="code" href="classCZipSplitNamesHandler.html">CZipSplitNamesHandler</a>* pNames, <span class="keywordtype">bool</span> bAutoDelete = <span class="keyword">true</span>)
<a name="l00649"></a>00649  {
<a name="l00650"></a>00650   <span class="keywordflow">return</span> m_storage.SetSplitNamesHandler(pNames, bAutoDelete);
<a name="l00651"></a>00651  }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653  
<a name="l00658"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdb">00658</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdb">OpenMode</a>
<a name="l00659"></a>00659  {
<a name="l00660"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba7932d6a8eb7d436b5003d0e2d6c10b7e">00660</a>   zipOpen    = 0x0001,    
<a name="l00661"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbabf5fdf56b9ed21bb4439d72efbefb13d">00661</a>   zipOpenReadOnly  = zipOpen | 0x0002,  
<a name="l00662"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbadcf20d3cf869207a53206f415bf5e1f5">00662</a>   zipCreate   = 0x0004,    
<a name="l00663"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba16ee2398b435a10f65b718e0ec1abd73">00663</a>   zipCreateAppend  = zipCreate | 0x0008, 
<a name="l00664"></a>00664 
<a name="l00665"></a>00665   zipModeSplit  = 0x0100, <span class="comment">// For the internal use only.</span>
<a name="l00666"></a>00666   zipModeBinSplit  = 0x0200, <span class="comment">// For the internal use only.</span>
<a name="l00667"></a>00667   zipModeSpan   = 0x0400, <span class="comment">// For the internal use only.</span>
<a name="l00668"></a>00668   zipModeSegmented = zipModeSplit | zipModeBinSplit | zipModeSpan, <span class="comment">// For the internal use only.</span>
<a name="l00669"></a>00669 
<a name="l00670"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba21ed466fd325c084dc196c288e08c0a4">00670</a>   zipCreateSplit  = zipCreate | zipModeSplit, 
<a name="l00671"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaa8db695ef08d26c03973af199a581a98">00671</a>   zipCreateBinSplit = zipCreate | zipModeBinSplit, 
<a name="l00672"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaffe1f8b7e73ce4f7db7702b2a22d6c22">00672</a>   zipCreateSpan  = zipCreate | zipModeSpan, 
<a name="l00673"></a>00673 
<a name="l00674"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba9a3e056d5fd80273cf6e5818faf22ef3">00674</a>   zipOpenSplit  = zipOpenReadOnly | zipModeSplit, 
<a name="l00675"></a><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaf374a2121958af7bbc33da4620b0d414">00675</a>   zipOpenBinSplit = zipOpenReadOnly | zipModeBinSplit 
<a name="l00676"></a>00676   
<a name="l00677"></a>00677  };
<a name="l00678"></a>00678 
<a name="l00709"></a>00709  <span class="keywordtype">bool</span> Open(LPCTSTR szPathName, <span class="keywordtype">int</span> iMode = zipOpen, ZIP_SIZE_TYPE uVolumeSize = 0);
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 
<a name="l00737"></a>00737  <span class="keywordtype">bool</span> Open(CZipAbstractFile&amp; af, <span class="keywordtype">int</span> iMode = zipOpen, <span class="keywordtype">bool</span> bAutoClose = <span class="keyword">false</span>);
<a name="l00738"></a>00738 
<a name="l00773"></a>00773  <span class="keywordtype">bool</span> OpenFrom(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>&amp; zip, CZipAbstractFile* pArchiveFile = NULL, <span class="keywordtype">bool</span> bAllowNonReadOnly = <span class="keyword">false</span>);
<a name="l00774"></a>00774 
<a name="l00797"></a>00797  <span class="keywordtype">void</span> SetRootPath(LPCTSTR szPath = NULL);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00809"></a><a class="code" href="classCZipArchive.html#a63d53a5a802a38ff64f796b12f7c374b">00809</a>  CZipString GetRootPath()<span class="keyword">const </span>
<a name="l00810"></a>00810 <span class="keyword"> </span>{
<a name="l00811"></a>00811   <span class="keywordflow">return</span> m_szRootPath;
<a name="l00812"></a>00812  }
<a name="l00813"></a>00813 
<a name="l00821"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669f">00821</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669f">Smartness</a>
<a name="l00822"></a>00822  {
<a name="l00823"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa4786128054ff353ce917e04c049c9b20">00823</a>   zipsmLazy   = 0x0000,  
<a name="l00824"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faf42c270f87cc3c94e708e5d5a36520b9">00824</a>   zipsmCPassDir  = 0x0001,  
<a name="l00825"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa6bf3035e3a5b79db2f25108c545b8f38">00825</a>   zipsmCPFile0  = 0x0002,  
<a name="l00826"></a>00826 
<a name="l00830"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faa3e9feeec5393fdeac3c78d2bb18770d">00830</a>   zipsmNotCompSmall = 0x0004,
<a name="l00831"></a>00831 
<a name="l00841"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fac8091f3b3088e300ce6eb90ee0e79858">00841</a>   zipsmCheckForEff = 0x0008,
<a name="l00842"></a>00842 
<a name="l00848"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fac565ef877f837250f6e6c72239e3e7e2">00848</a>   zipsmMemoryFlag  = 0x0010,
<a name="l00849"></a>00849 
<a name="l00854"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa1937c9053c208a1509601d1b83167e64">00854</a>   zipsmCheckForEffInMem = zipsmMemoryFlag | zipsmCheckForEff,
<a name="l00855"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fabf5d35dc579ac5a993632af2eb3f70b4">00855</a>   zipsmSmartPass = zipsmCPassDir | zipsmCPFile0,   
<a name="l00856"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faa8bdb16f8e81b8bf967d67e0aff5a2a6">00856</a>   zipsmSmartAdd = zipsmNotCompSmall | zipsmCheckForEff, 
<a name="l00857"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa54480b73a36e09e82defde88ab7a6a38">00857</a>   zipsmSafeSmart = zipsmSmartPass | zipsmNotCompSmall,    
<a name="l00858"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa942dfc422b0f66642e23b74b4fa8b31e">00858</a>   zipsmSmartest = zipsmSmartPass | zipsmSmartAdd,   
<a name="l00859"></a>00859 
<a name="l00866"></a><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa7e8d3011ce6b197006df0e7b4450359e">00866</a>   zipsmIgnoreDirectories = 0x0020,
<a name="l00867"></a>00867 
<a name="l00868"></a>00868   zipsmInternal01  = 0xf000   <span class="comment">// For the internal use only.</span>
<a name="l00869"></a>00869  };
<a name="l00870"></a>00870 
<a name="l00871"></a>00871  
<a name="l00904"></a>00904  <span class="keywordtype">bool</span> AddNewFile(<a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>&amp; info);
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 
<a name="l00913"></a>00913  <span class="keywordtype">bool</span> AddNewFile(LPCTSTR lpszFilePath, <span class="keywordtype">int</span> iComprLevel = -1, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>,
<a name="l00914"></a>00914   <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 
<a name="l00922"></a>00922  <span class="keywordtype">bool</span> AddNewFile(LPCTSTR lpszFilePath,
<a name="l00923"></a>00923         LPCTSTR lpszFileNameInZip,
<a name="l00924"></a>00924                              <span class="keywordtype">int</span> iComprLevel = -1,                             
<a name="l00925"></a>00925         <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,
<a name="l00926"></a>00926                              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);
<a name="l00927"></a>00927 
<a name="l00933"></a>00933  <span class="keywordtype">bool</span> AddNewFile(CZipAbstractFile&amp; af,
<a name="l00934"></a>00934         LPCTSTR lpszFileNameInZip,
<a name="l00935"></a>00935                              <span class="keywordtype">int</span> iComprLevel = -1,                             
<a name="l00936"></a>00936         <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,
<a name="l00937"></a>00937                              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 
<a name="l00990"></a>00990  <span class="keywordtype">bool</span> AddNewFiles(LPCTSTR lpszPath,
<a name="l00991"></a>00991       <a class="code" href="classZipArchiveLib_1_1CFileFilter.html">ZipArchiveLib::CFileFilter</a>&amp; filter,
<a name="l00992"></a>00992       <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>,
<a name="l00993"></a>00993       <span class="keywordtype">int</span> iComprLevel = -1,
<a name="l00994"></a>00994       <span class="keywordtype">bool</span> bSkipInitialPath = <span class="keyword">true</span>,
<a name="l00995"></a>00995       <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,
<a name="l00996"></a>00996       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);
<a name="l00997"></a>00997 
<a name="l01042"></a><a class="code" href="classCZipArchive.html#a4edbda7e98bb8b51b98d0f413b062703">01042</a>  <span class="keywordtype">bool</span> AddNewFiles(LPCTSTR lpszPath, 
<a name="l01043"></a>01043       LPCTSTR lpszFileMask = _T(<span class="stringliteral">&quot;*.*&quot;</span>), 
<a name="l01044"></a>01044       <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>, 
<a name="l01045"></a>01045       <span class="keywordtype">int</span> iComprLevel = -1, 
<a name="l01046"></a>01046       <span class="keywordtype">bool</span> bSkipInitialPath = <span class="keyword">true</span>, 
<a name="l01047"></a>01047       <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart, 
<a name="l01048"></a>01048       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536)
<a name="l01049"></a>01049  {
<a name="l01050"></a>01050   <a class="code" href="classZipArchiveLib_1_1CNameFileFilter.html">ZipArchiveLib::CNameFileFilter</a> filter(lpszFileMask);
<a name="l01051"></a>01051   <span class="keywordflow">return</span> AddNewFiles(lpszPath, filter, bRecursive, iComprLevel, 
<a name="l01052"></a>01052    bSkipInitialPath, iSmartLevel, nBufSize);
<a name="l01053"></a>01053  }
<a name="l01054"></a>01054 
<a name="l01061"></a><a class="code" href="classCZipArchive.html#a6a72dbdd7f9496ecbb9ad84979dbcb80">01061</a>  ZIP_INDEX_TYPE GetLastIndexAdded()<span class="keyword"> const</span>
<a name="l01062"></a>01062 <span class="keyword"> </span>{
<a name="l01063"></a>01063   <span class="keywordflow">return</span> m_centralDir.GetLastIndexAdded();
<a name="l01064"></a>01064  }
<a name="l01065"></a>01065 
<a name="l01124"></a><a class="code" href="classCZipArchive.html#a6065bf986f315928dd4945d3bec495cd">01124</a>  <span class="keywordtype">bool</span> OpenNewFile(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; header, <span class="keywordtype">int</span> iLevel = <a class="code" href="classCZipCompressor.html#a7fada8bbd7698360872cbc166f20cae7accc91672b5fe070b6151d98772399488" title="The default compression level (equals 6 for deflate).">CZipCompressor::levelDefault</a>, LPCTSTR lpszFilePath = NULL)
<a name="l01125"></a>01125  {
<a name="l01126"></a>01126   <span class="keywordflow">return</span> OpenNewFile(header, iLevel, lpszFilePath, ZIP_FILE_INDEX_UNSPECIFIED);
<a name="l01127"></a>01127  }
<a name="l01128"></a>01128 
<a name="l01149"></a>01149  <span class="keywordtype">bool</span> WriteNewFile(<span class="keyword">const</span> <span class="keywordtype">void</span> *pBuf, DWORD uSize);
<a name="l01150"></a>01150 
<a name="l01169"></a>01169  <span class="keywordtype">bool</span> CloseNewFile(<span class="keywordtype">bool</span> bAfterException = <span class="keyword">false</span>);
<a name="l01170"></a>01170 
<a name="l01223"></a><a class="code" href="classCZipArchive.html#a648b5aa0358a5b4e77affc3dbc1ede11">01223</a>  <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>&amp; zip, ZIP_INDEX_TYPE uIndex, LPCTSTR lpszNewFileName = NULL, ZIP_INDEX_TYPE uReplaceIndex = ZIP_FILE_INDEX_UNSPECIFIED, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>)
<a name="l01224"></a>01224  {    
<a name="l01225"></a>01225   InitBuffer();
<a name="l01226"></a>01226   <span class="keywordtype">bool</span> bRet;
<a name="l01227"></a>01227   <span class="keywordflow">try</span>
<a name="l01228"></a>01228   {
<a name="l01229"></a>01229    bRet = GetFromArchive(zip, uIndex, lpszNewFileName, uReplaceIndex, bKeepSystComp, GetCallback(<a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734a3b1d7784f0f9cb69b22cee675b965f8c">CZipActionCallback::cbGet</a>));
<a name="l01230"></a>01230   }
<a name="l01231"></a>01231   <span class="keywordflow">catch</span>(...)
<a name="l01232"></a>01232   {
<a name="l01233"></a>01233    ReleaseBuffer();
<a name="l01234"></a>01234    <span class="keywordflow">throw</span>;
<a name="l01235"></a>01235   }
<a name="l01236"></a>01236   ReleaseBuffer();
<a name="l01237"></a>01237   <span class="keywordflow">if</span> (bRet)
<a name="l01238"></a>01238    Finalize(<span class="keyword">true</span>);
<a name="l01239"></a>01239 
<a name="l01240"></a>01240   <span class="keywordflow">return</span> bRet;
<a name="l01241"></a>01241  }
<a name="l01242"></a>01242 
<a name="l01289"></a>01289  <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>&amp; zip, CZipIndexesArray &amp;aIndexes, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>);
<a name="l01290"></a>01290  
<a name="l01339"></a><a class="code" href="classCZipArchive.html#a089c9e3fa4d74ef21585b0b749b15ab5">01339</a>  <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>&amp; zip, CZipStringArray &amp;aNames, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>)
<a name="l01340"></a>01340  {
<a name="l01341"></a>01341   CZipIndexesArray indexes;
<a name="l01342"></a>01342   zip.<a class="code" href="classCZipArchive.html#a95573d33042d4adc73f36f4b1a7a0b3a">GetIndexes</a>(aNames, indexes);
<a name="l01343"></a>01343   <span class="keywordflow">return</span> GetFromArchive(zip, indexes, bKeepSystComp);
<a name="l01344"></a>01344  }
<a name="l01345"></a>01345 
<a name="l01364"></a>01364  <span class="keywordtype">void</span> GetIndexes(<span class="keyword">const</span> CZipStringArray &amp;aNames, CZipIndexesArray&amp; aIndexes);
<a name="l01365"></a>01365 
<a name="l01427"></a>01427  <span class="keywordtype">bool</span> ExtractFile(ZIP_INDEX_TYPE uIndex,
<a name="l01428"></a>01428   LPCTSTR lpszPath,
<a name="l01429"></a>01429   <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>,
<a name="l01430"></a>01430   LPCTSTR lpszNewName = NULL,
<a name="l01431"></a>01431   <a class="code" href="namespaceZipPlatform.html#a3f76c6f54e0ec15a141691a9df49f941">ZipPlatform::DeleteFileMode</a> iOverwriteMode = <a class="code" href="namespaceZipPlatform.html#a3f76c6f54e0ec15a141691a9df49f941a76497c57fb3ca826ba839b08be094b13" title="No special action is taken when overwriting a file.">ZipPlatform::dfmRegular</a>,
<a name="l01432"></a>01432   DWORD nBufSize = 65536);
<a name="l01433"></a>01433  
<a name="l01466"></a>01466  <span class="keywordtype">bool</span> ExtractFile(ZIP_INDEX_TYPE uIndex,
<a name="l01467"></a>01467   CZipAbstractFile&amp; af,
<a name="l01468"></a>01468   <span class="keywordtype">bool</span> bRewind = <span class="keyword">true</span>,
<a name="l01469"></a>01469   DWORD nBufSize = 65536);
<a name="l01470"></a>01470 
<a name="l01494"></a>01494  <span class="keywordtype">bool</span> <a class="code" href="namespaceZipPlatform.html#a3c1d17d400f71485ff45bba1a43aa411">OpenFile</a>(ZIP_INDEX_TYPE uIndex);
<a name="l01495"></a>01495 
<a name="l01514"></a>01514  DWORD ReadFile(<span class="keywordtype">void</span> *pBuf, DWORD uSize);
<a name="l01515"></a>01515 
<a name="l01516"></a>01516 
<a name="l01545"></a>01545  <span class="keywordtype">int</span> CloseFile(LPCTSTR lpszFilePath = NULL, <span class="keywordtype">bool</span> bAfterException = <span class="keyword">false</span>);
<a name="l01546"></a>01546 
<a name="l01566"></a>01566  <span class="keywordtype">int</span> CloseFile(CZipFile &amp;file);
<a name="l01567"></a>01567 
<a name="l01589"></a>01589  <span class="keywordtype">bool</span> TestFile(ZIP_INDEX_TYPE uIndex, DWORD uBufSize = 65536);
<a name="l01590"></a>01590 
<a name="l01618"></a>01618  <span class="keywordtype">bool</span> <a class="code" href="namespaceZipPlatform.html#aa85a6cb5225005b741ac42364d0eff5a" title="Removes a file.">RemoveFile</a>(ZIP_INDEX_TYPE uIndex, <span class="keywordtype">bool</span> bRemoveData = <span class="keyword">true</span>);
<a name="l01619"></a>01619 
<a name="l01644"></a>01644  <span class="keywordtype">bool</span> RemoveFiles(CZipIndexesArray&amp; aIndexes);
<a name="l01645"></a>01645 
<a name="l01646"></a>01646 
<a name="l01670"></a>01670  <span class="keywordtype">bool</span> RemoveFiles(<span class="keyword">const</span> CZipStringArray&amp; aNames);
<a name="l01671"></a>01671 
<a name="l01695"></a>01695  <span class="keywordtype">bool</span> ShiftData(ZIP_SIZE_TYPE uOffset);
<a name="l01696"></a>01696 
<a name="l01726"></a>01726  <span class="keywordtype">bool</span> PrependData(LPCTSTR lpszFilePath, LPCTSTR lpszNewExt = 
<a name="l01727"></a>01727 #ifdef _ZIP_SYSTEM_WIN
<a name="l01728"></a>01728   _T(<span class="stringliteral">&quot;exe&quot;</span>)
<a name="l01729"></a>01729 #<span class="keywordflow">else</span>
<a name="l01730"></a>01730   _T(<span class="stringliteral">&quot;&quot;</span>)
<a name="l01731"></a>01731 #endif
<a name="l01732"></a>01732   );
<a name="l01733"></a>01733 
<a name="l01762"></a>01762  <span class="keywordtype">bool</span> PrependData(CZipAbstractFile&amp; file, LPCTSTR lpszNewExt = NULL);
<a name="l01763"></a>01763 
<a name="l01782"></a>01782  <span class="keywordtype">bool</span> SetGlobalComment(LPCTSTR lpszComment, UINT codePage = ZIP_DEFAULT_CODE_PAGE);
<a name="l01783"></a>01783 
<a name="l01784"></a>01784 
<a name="l01796"></a>01796  CZipString GetGlobalComment()<span class="keyword">const</span> ;
<a name="l01797"></a>01797 
<a name="l01798"></a>01798  
<a name="l01807"></a>01807  CZipString GetArchivePath()<span class="keyword">const</span>;
<a name="l01808"></a>01808 
<a name="l01822"></a>01822  ZIP_VOLUME_TYPE GetCurrentVolume() <span class="keyword">const</span> ;
<a name="l01823"></a>01823  
<a name="l01831"></a><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445">01831</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445">FFCaseSens</a>
<a name="l01832"></a>01832  {
<a name="l01839"></a><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a444f27e5af71ea1123c74ebd81782484">01839</a>   <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a444f27e5af71ea1123c74ebd81782484">ffDefault</a>,
<a name="l01840"></a>01840 
<a name="l01847"></a><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a04a52dbca5df0c96804960c1e1d724f0">01847</a>   <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a04a52dbca5df0c96804960c1e1d724f0">ffCaseSens</a>,
<a name="l01848"></a>01848 
<a name="l01855"></a><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a7d8e3774e9edba7bcf4e4a646ef78d12">01855</a>   ffNoCaseSens
<a name="l01856"></a>01856  };
<a name="l01857"></a>01857 
<a name="l01887"></a>01887  ZIP_INDEX_TYPE FindFile(LPCTSTR lpszFileName, <span class="keywordtype">int</span> iCaseSensitive = ffDefault, <span class="keywordtype">bool</span> bFileNameOnly = <span class="keyword">false</span>);
<a name="l01888"></a>01888 
<a name="l01914"></a>01914  <span class="keywordtype">bool</span> GetFileInfo(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; fhInfo, ZIP_INDEX_TYPE uIndex) <span class="keyword">const</span>;
<a name="l01915"></a>01915 
<a name="l01941"></a>01941  <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* GetFileInfo(ZIP_INDEX_TYPE uIndex);
<a name="l01942"></a>01942 
<a name="l01967"></a>01967  <span class="keyword">const</span> <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* GetFileInfo(ZIP_INDEX_TYPE uIndex) <span class="keyword">const</span>;
<a name="l01968"></a>01968 
<a name="l01993"></a><a class="code" href="classCZipArchive.html#a51e1539faed798f0524cbfa7c47f5513">01993</a>  <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* operator[](ZIP_INDEX_TYPE uIndex)
<a name="l01994"></a>01994  {
<a name="l01995"></a>01995   <span class="keywordflow">return</span> GetFileInfo(uIndex);
<a name="l01996"></a>01996  }
<a name="l01997"></a>01997 
<a name="l02021"></a><a class="code" href="classCZipArchive.html#a131d33178f4663782c092666a99a89c5">02021</a>  <span class="keyword">const</span> <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* operator[](ZIP_INDEX_TYPE uIndex)<span class="keyword"> const</span>
<a name="l02022"></a>02022 <span class="keyword"> </span>{
<a name="l02023"></a>02023   <span class="keywordflow">return</span> GetFileInfo(uIndex);
<a name="l02024"></a>02024  }
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 
<a name="l02039"></a><a class="code" href="classCZipArchive.html#ab3bdd0322dd12c40434cd8f0d9ad2523">02039</a>  ZIP_INDEX_TYPE GetCount(<span class="keywordtype">bool</span> bOnlyFiles)
<a name="l02040"></a>02040  {
<a name="l02041"></a>02041   <span class="keywordflow">if</span> (IsClosed())
<a name="l02042"></a>02042    <span class="keywordflow">return</span> 0;
<a name="l02043"></a>02043 
<a name="l02044"></a>02044   ZIP_INDEX_TYPE iTotalCount = GetCount();
<a name="l02045"></a>02045   <span class="keywordflow">if</span> (bOnlyFiles)
<a name="l02046"></a>02046   {
<a name="l02047"></a>02047    ZIP_INDEX_TYPE iCount = 0;
<a name="l02048"></a>02048    <span class="keywordflow">for</span> (ZIP_INDEX_TYPE i = 0; i &lt; iTotalCount; i++)
<a name="l02049"></a>02049    {
<a name="l02050"></a>02050     <span class="keywordflow">if</span> (!m_centralDir[i]-&gt;<a class="code" href="namespaceZipPlatform.html#a62a6f9cb5d789c22c3fc035a3260dbde">IsDirectory</a>())
<a name="l02051"></a>02051      iCount++;
<a name="l02052"></a>02052    }
<a name="l02053"></a>02053    <span class="keywordflow">return</span> iCount;
<a name="l02054"></a>02054   }
<a name="l02055"></a>02055   <span class="keywordflow">else</span>
<a name="l02056"></a>02056    <span class="keywordflow">return</span> iTotalCount;
<a name="l02057"></a>02057  }
<a name="l02058"></a>02058 
<a name="l02066"></a><a class="code" href="classCZipArchive.html#a50fa2f64fc0150c7685fb1f52adf747f">02066</a>  ZIP_INDEX_TYPE GetCount()<span class="keyword"> const</span>
<a name="l02067"></a>02067 <span class="keyword"> </span>{
<a name="l02068"></a>02068   <span class="keywordflow">return</span> (ZIP_INDEX_TYPE) m_centralDir.GetCount();
<a name="l02069"></a>02069  }
<a name="l02070"></a>02070 
<a name="l02071"></a>02071 
<a name="l02082"></a><a class="code" href="classCZipArchive.html#abc708f54f7523070c2043aed3e92e263">02082</a>  ZIP_SIZE_TYPE GetOccupiedSpace()<span class="keyword"> const</span>
<a name="l02083"></a>02083 <span class="keyword"> </span>{
<a name="l02084"></a>02084   <span class="keywordflow">if</span> (IsClosed(<span class="keyword">true</span>) || IsClosed(<span class="keyword">false</span>))
<a name="l02085"></a>02085   {
<a name="l02086"></a>02086    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive or the current volume file is closed.\n&quot;</span>);
<a name="l02087"></a>02087    <span class="keywordflow">return</span> 0;
<a name="l02088"></a>02088   }
<a name="l02089"></a>02089   <span class="keywordflow">return</span> m_storage.GetOccupiedSpace() + m_centralDir.GetSize(<span class="keyword">true</span>);
<a name="l02090"></a>02090  }
<a name="l02091"></a>02091 
<a name="l02095"></a><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802">02095</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802">CloseAfterException</a>
<a name="l02096"></a>02096  {
<a name="l02100"></a><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802ac1f4cb9f2ddacd20cc121c66504cb657">02100</a>   <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802ac1f4cb9f2ddacd20cc121c66504cb657">afNoException</a>,
<a name="l02101"></a>02101 
<a name="l02107"></a><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a64383ab2ba2586c69af5add1a1c6d665">02107</a>   <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a64383ab2ba2586c69af5add1a1c6d665">afAfterException</a>,
<a name="l02108"></a>02108 
<a name="l02114"></a><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a037ed078fff70fca7148d375c2015677">02114</a>   afWriteDir
<a name="l02115"></a>02115  };
<a name="l02116"></a>02116 
<a name="l02140"></a>02140  CZipString Close(<span class="keywordtype">int</span> iAfterException = afNoException, <span class="keywordtype">bool</span> bUpdateTimeStamp = <span class="keyword">false</span>);
<a name="l02141"></a>02141 
<a name="l02142"></a>02142 
<a name="l02155"></a><a class="code" href="classCZipArchive.html#a60166588e0126c68899860e00676a51f">02155</a>  <span class="keywordtype">bool</span> IsClosed(<span class="keywordtype">bool</span> bArchive = <span class="keyword">true</span>)<span class="keyword">const</span>
<a name="l02156"></a>02156 <span class="keyword"> </span>{
<a name="l02157"></a>02157   <span class="keywordflow">return</span> m_storage.IsClosed(bArchive);
<a name="l02158"></a>02158  }
<a name="l02159"></a>02159 
<a name="l02185"></a>02185  <span class="keywordtype">bool</span> Finalize(<span class="keywordtype">bool</span> bOnlyIfAuto = <span class="keyword">false</span>);
<a name="l02186"></a>02186 
<a name="l02195"></a><a class="code" href="classCZipArchive.html#a72e5c3c86552c535d764c3da4e8ce163">02195</a>  <span class="keywordtype">void</span> FlushBuffers()
<a name="l02196"></a>02196  {
<a name="l02197"></a>02197   <span class="keywordflow">if</span> (IsClosed())
<a name="l02198"></a>02198   {
<a name="l02199"></a>02199    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive should be opened first.\n&quot;</span>);
<a name="l02200"></a>02200    <span class="keywordflow">return</span>;
<a name="l02201"></a>02201   }
<a name="l02202"></a>02202 
<a name="l02203"></a>02203   m_storage.FlushBuffers();
<a name="l02204"></a>02204  }
<a name="l02205"></a>02205 
<a name="l02206"></a>02206 
<a name="l02224"></a>02224  <span class="keywordtype">bool</span> SetAutoFinalize(<span class="keywordtype">bool</span> bAutoFinalize = <span class="keyword">true</span>);
<a name="l02225"></a>02225  
<a name="l02226"></a>02226 
<a name="l02240"></a><a class="code" href="classCZipArchive.html#afb30ad3cbaf8726630b2fa0933f91482">02240</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#afb30ad3cbaf8726630b2fa0933f91482">GetAutoFinalize</a>()<span class="keyword">const </span>{<span class="keywordflow">return</span> m_bAutoFinalize;}
<a name="l02241"></a>02241 
<a name="l02269"></a>02269  <span class="keywordtype">bool</span> SetSystemCompatibility(<span class="keywordtype">int</span> iSystemComp);
<a name="l02270"></a>02270 
<a name="l02288"></a><a class="code" href="classCZipArchive.html#a5cd378df6bf6c5e119aed6f06bc921cc">02288</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a5cd378df6bf6c5e119aed6f06bc921cc">GetSystemCompatibility</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_iArchiveSystCompatib;}
<a name="l02289"></a>02289 
<a name="l02299"></a><a class="code" href="classCZipArchive.html#af2cb18a0c834f64284f6485b01df50a8">02299</a>  <a class="code" href="classCZipStorage.html">CZipStorage</a>* <a class="code" href="classCZipArchive.html#af2cb18a0c834f64284f6485b01df50a8">GetStorage</a>(){<span class="keywordflow">return</span> &amp;m_storage;}
<a name="l02300"></a>02300 
<a name="l02301"></a>02301 <span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span>
<a name="l02302"></a>02302 <span class="preprocessor"></span>
<a name="l02319"></a><a class="code" href="classCZipArchive.html#ac497dc2ebb4b65be1f5b7d08fe024a29">02319</a>  <span class="keywordtype">void</span> SetStringStoreSettings(<span class="keyword">const</span> <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a>&amp; settings)
<a name="l02320"></a>02320  {
<a name="l02321"></a>02321   m_stringSettings = settings;
<a name="l02322"></a>02322  }
<a name="l02323"></a>02323 
<a name="l02347"></a><a class="code" href="classCZipArchive.html#a6eadc5f798ca0897e025c2d79771bbd4">02347</a>  <span class="keywordtype">void</span> SetStringStoreSettings(UINT uFileNameCodePage, <span class="keywordtype">bool</span> bStoreNameInExtraData, UINT uCommentCodePage)
<a name="l02348"></a>02348  {
<a name="l02349"></a>02349   m_stringSettings.<a class="code" href="classCZipStringStoreSettings.html#ab6c7c033a9c051fd3cbe5427d521c657">Set</a>(uFileNameCodePage, bStoreNameInExtraData, uCommentCodePage);
<a name="l02350"></a>02350  }
<a name="l02351"></a>02351 
<a name="l02373"></a><a class="code" href="classCZipArchive.html#a6a2d19de8bb5cc3939bc0d4dce1c1150">02373</a>  <span class="keywordtype">void</span> SetStringStoreSettings(UINT uFileNameCodePage, <span class="keywordtype">bool</span> bStoreNameInExtraData = <span class="keyword">false</span>)
<a name="l02374"></a>02374  {
<a name="l02375"></a>02375   SetStringStoreSettings(uFileNameCodePage, bStoreNameInExtraData,  m_stringSettings.m_uCommentCodePage);
<a name="l02376"></a>02376  }
<a name="l02377"></a>02377  
<a name="l02393"></a><a class="code" href="classCZipArchive.html#a81a15f347bad84ffaeee0c8eff3b98db">02393</a>  <span class="keywordtype">void</span> ResetStringStoreSettings()
<a name="l02394"></a>02394  {
<a name="l02395"></a>02395   m_stringSettings.Reset(m_iArchiveSystCompatib);
<a name="l02396"></a>02396  }
<a name="l02397"></a>02397 
<a name="l02417"></a><a class="code" href="classCZipArchive.html#a54f26713f4bc6c808250fe5a0b8b0565">02417</a>  <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a>&amp; GetStringStoreSettings()
<a name="l02418"></a>02418  {
<a name="l02419"></a>02419   <span class="keywordflow">return</span> m_stringSettings;
<a name="l02420"></a>02420  }
<a name="l02421"></a>02421 <span class="preprocessor">#endif</span>
<a name="l02422"></a>02422 <span class="preprocessor"></span>
<a name="l02429"></a><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80e">02429</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80e">UnicodeMode</a>
<a name="l02430"></a>02430  {
<a name="l02431"></a><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80ea0069414c73e257bae21ffdc7970539d1">02431</a>   umNone  = 0x00, 
<a name="l02432"></a>02432 <span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span>
<a name="l02433"></a><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80eacf7f0e438c63ad9562aad7d2d990093c">02433</a> <span class="preprocessor"></span>  umCustom = 0x04 
<a name="l02434"></a>02434 <span class="preprocessor">#endif</span>
<a name="l02435"></a>02435 <span class="preprocessor"></span> };
<a name="l02436"></a>02436 
<a name="l02446"></a><a class="code" href="classCZipArchive.html#a56e17863ae02b8a6dc6c1149b71568a4">02446</a>  <span class="keywordtype">void</span> <a class="code" href="classCZipArchive.html#a56e17863ae02b8a6dc6c1149b71568a4">SetUnicodeMode</a>(<span class="keywordtype">int</span> iMode){ m_centralDir.SetUnicodeMode(iMode); }
<a name="l02447"></a>02447 
<a name="l02457"></a><a class="code" href="classCZipArchive.html#a25603e19d2c08a0399a7c2ea890bce6f">02457</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a25603e19d2c08a0399a7c2ea890bce6f">GetUnicodeMode</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_centralDir.GetUnicodeMode(); }
<a name="l02458"></a>02458 
<a name="l02471"></a>02471  <span class="keywordtype">void</span> EnableFindFast(<span class="keywordtype">bool</span> bEnable = <span class="keyword">true</span>);
<a name="l02472"></a>02472 
<a name="l02473"></a>02473 
<a name="l02492"></a><a class="code" href="classCZipArchive.html#ad5f980abfefe3f4e075da12623d13274">02492</a>  ZIP_INDEX_TYPE GetFindFastIndex(ZIP_INDEX_TYPE iFindFastIndex)<span class="keyword"> const</span>
<a name="l02493"></a>02493 <span class="keyword"> </span>{
<a name="l02494"></a>02494   <span class="keywordflow">if</span> (IsClosed())
<a name="l02495"></a>02495   {
<a name="l02496"></a>02496    ZIPTRACE(<span class="stringliteral">&quot;CZipArchive::GetFindFastIndex: ZipArchive should be opened first.\n&quot;</span>);
<a name="l02497"></a>02497    <span class="keywordflow">return</span> ZIP_FILE_INDEX_UNSPECIFIED;
<a name="l02498"></a>02498   }
<a name="l02499"></a>02499   
<a name="l02500"></a>02500   <span class="keywordflow">return</span> m_centralDir.GetFindFastIndex(iFindFastIndex);
<a name="l02501"></a>02501  }
<a name="l02502"></a>02502 
<a name="l02503"></a>02503 
<a name="l02531"></a>02531  <span class="keywordtype">void</span> SetTempPath(LPCTSTR lpszPath = NULL, <span class="keywordtype">bool</span> bForce = <span class="keyword">true</span>);
<a name="l02532"></a>02532 
<a name="l02542"></a><a class="code" href="classCZipArchive.html#aaeeed7da4af0194d9792e4fd2b25dd5f">02542</a>  CZipString GetTempPath()<span class="keyword">const </span>
<a name="l02543"></a>02543 <span class="keyword"> </span>{
<a name="l02544"></a>02544   <span class="keywordflow">return</span> m_szTempPath;
<a name="l02545"></a>02545  }
<a name="l02546"></a>02546 
<a name="l02550"></a><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724f">02550</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724f">Predict</a>
<a name="l02551"></a>02551  {
<a name="l02552"></a>02552  
<a name="l02553"></a><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fafc6c23f7a1c59e62127bb244a693e28a">02553</a>   <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fafc6c23f7a1c59e62127bb244a693e28a" title="If lpszFilePath is a directory, appends a separator.">prDir</a>,  
<a name="l02554"></a><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa551c4f6dbe8566f9702de2d4f3cb0eb4">02554</a>   <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa551c4f6dbe8566f9702de2d4f3cb0eb4" title="Treats lpszFilePath as a common file.">prFile</a>, 
<a name="l02555"></a><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa36adfe21a31a4f045b9ebfe265e2f017">02555</a>   prAuto  
<a name="l02556"></a>02556  };
<a name="l02557"></a>02557 
<a name="l02572"></a>02572  CZipString PredictFileNameInZip(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath, <span class="keywordtype">int</span> iWhat = prAuto)<span class="keyword">const</span> ;
<a name="l02573"></a>02573 
<a name="l02606"></a>02606  ZIP_SIZE_TYPE PredictMaximumFileSizeInArchive(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; fh);
<a name="l02607"></a>02607 
<a name="l02625"></a>02625  ZIP_SIZE_TYPE PredictMaximumFileSizeInArchive(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath);
<a name="l02626"></a>02626  
<a name="l02627"></a>02627 
<a name="l02648"></a>02648  ZIP_INDEX_TYPE WillBeDuplicated(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath, <span class="keywordtype">bool</span> bFileNameOnly = <span class="keyword">false</span>, <span class="keywordtype">int</span> iWhat = prAuto);
<a name="l02649"></a>02649 
<a name="l02668"></a>02668  CZipString PredictExtractedFileName(LPCTSTR lpszFileNameInZip, LPCTSTR lpszPath, <span class="keywordtype">bool</span> bFullPath, LPCTSTR lpszNewName = NULL)<span class="keyword">const</span> ;
<a name="l02669"></a>02669 
<a name="l02670"></a>02670 
<a name="l02680"></a>02680  CZipString TrimRootPath(<a class="code" href="classCZipPathComponent.html">CZipPathComponent</a>&amp; zpc) <span class="keyword">const</span> ;
<a name="l02681"></a>02681 
<a name="l02698"></a>02698  <span class="keyword">static</span> <span class="keywordtype">bool</span> RemovePathBeginning(LPCTSTR lpszBeginning, CZipString&amp; szPath, ZIPSTRINGCOMPARE pCompareFunction);
<a name="l02699"></a>02699 
<a name="l02721"></a><a class="code" href="classCZipArchive.html#aec981beb4dfb55e4a2f054c410ee3031">02721</a>  <span class="keywordtype">void</span> SetCaseSensitivity(<span class="keywordtype">bool</span> bCaseSensitive) 
<a name="l02722"></a>02722  {
<a name="l02723"></a>02723   m_bCaseSensitive = bCaseSensitive;
<a name="l02724"></a>02724   m_pZipCompare = GetCZipStrCompFunc(bCaseSensitive);
<a name="l02725"></a>02725  }
<a name="l02726"></a>02726 
<a name="l02727"></a>02727  <span class="comment">/*</span>
<a name="l02728"></a>02728 <span class="comment">  Returns the current case sensitivity.</span>
<a name="l02729"></a>02729 <span class="comment">  </span>
<a name="l02730"></a>02730 <span class="comment">  \return </span>
<a name="l02731"></a>02731 <span class="comment">   \c true, if the archive is case-sensitive; \c false otherwise.</span>
<a name="l02732"></a>02732 <span class="comment"></span>
<a name="l02733"></a>02733 <span class="comment">  \see</span>
<a name="l02734"></a>02734 <span class="comment">   SetCaseSensitivity</span>
<a name="l02735"></a>02735 <span class="comment"> */</span>
<a name="l02736"></a>02736  <span class="keywordtype">bool</span> GetCaseSensitivity()<span class="keyword"> const</span>
<a name="l02737"></a>02737 <span class="keyword"> </span>{
<a name="l02738"></a>02738   <span class="keywordflow">return</span> m_bCaseSensitive;
<a name="l02739"></a>02739  }
<a name="l02740"></a>02740 
<a name="l02749"></a>02749  <span class="keywordtype">void</span> GetCentralDirInfo(<a class="code" href="structCZipCentralDir_1_1CInfo.html">CZipCentralDir::CInfo</a>&amp; info)<span class="keyword">const</span>;
<a name="l02750"></a>02750  
<a name="l02751"></a>02751 
<a name="l02764"></a><a class="code" href="classCZipArchive.html#ae67accf5d79f14ffc57ec17833dc7623">02764</a>  ZIP_SIZE_TYPE GetCentralDirSize(<span class="keywordtype">bool</span> bWhole = <span class="keyword">true</span>)<span class="keyword"> const</span>
<a name="l02765"></a>02765 <span class="keyword"> </span>{
<a name="l02766"></a>02766   <span class="keywordflow">if</span> (IsClosed())
<a name="l02767"></a>02767   {
<a name="l02768"></a>02768    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive is closed.\n&quot;</span>);
<a name="l02769"></a>02769    <span class="keywordflow">return</span> 0;
<a name="l02770"></a>02770   }
<a name="l02771"></a>02771   <span class="keywordflow">return</span> m_centralDir.GetSize(bWhole);
<a name="l02772"></a>02772  }
<a name="l02773"></a>02773 
<a name="l02782"></a><a class="code" href="classCZipArchive.html#ac50bc9678b14ae075d2c252f0b38bd0d">02782</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#ac50bc9678b14ae075d2c252f0b38bd0d">IsReadOnly</a>(){<span class="keywordflow">return</span> m_storage.IsReadOnly();} <span class="keyword">const</span>
<a name="l02783"></a>02783 
<a name="l02795"></a><a class="code" href="classCZipArchive.html#a8507cdbe74b6698a74f247c1c8bdbab8">02795</a>  <span class="keywordtype">void</span> SetBytesBeforeZip(ZIP_SIZE_TYPE uCount = 0)
<a name="l02796"></a>02796  {
<a name="l02797"></a>02797   <span class="keywordflow">if</span> (!IsClosed())
<a name="l02798"></a>02798   {
<a name="l02799"></a>02799    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it before opening the archive.\n&quot;</span>);
<a name="l02800"></a>02800    <span class="keywordflow">return</span>;
<a name="l02801"></a>02801   }
<a name="l02802"></a>02802   m_storage.m_uBytesBeforeZip = uCount;
<a name="l02803"></a>02803  }
<a name="l02804"></a>02804 
<a name="l02813"></a><a class="code" href="classCZipArchive.html#aca3e489f54afcd72390093e853af822e">02813</a>  ZIP_SIZE_TYPE GetBytesBeforeZip()<span class="keyword"> const</span>
<a name="l02814"></a>02814 <span class="keyword"> </span>{
<a name="l02815"></a>02815   <span class="keywordflow">return</span> m_storage.m_uBytesBeforeZip;
<a name="l02816"></a>02816  }
<a name="l02817"></a>02817 
<a name="l02822"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4d">02822</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4d">ConsistencyCheck</a>
<a name="l02823"></a>02823  {  
<a name="l02824"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da611deca107b7fc16b2e255972e3ff999">02824</a>   <a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da611deca107b7fc16b2e255972e3ff999" title="If used in the SetIgnoredConsistencyChecks method, examines all possible inconsistencies in an archiv...">checkNone</a>,       
<a name="l02825"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dafee0cd5bb67d85fe0256fabfc3b8d8d6">02825</a>   checkCRC    = 0x0001, 
<a name="l02826"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dae9a0cddb18592358dbd152fbec81f000">02826</a>   checkLocalMethod  = 0x0002, 
<a name="l02827"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dad3cd972f4b468d9c7136e5ca4517c745">02827</a>   checkLocalSizes   = 0x0004, 
<a name="l02828"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daf524b056991ec9941b55c5c49e3794c2">02828</a>   checkLocalCRC   = 0x0008, 
<a name="l02829"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dadf236f7324db99316807e1fce3b78327">02829</a>   checkLocalFlag   = 0x0010, 
<a name="l02830"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da444c069eb1e6f70192ff7b595d2db0a1">02830</a>   checkLocalAll   = checkLocalMethod | checkLocalSizes | checkLocalCRC | checkLocalFlag, 
<a name="l02831"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daff3c8c747216fe654286edcd57f55230">02831</a>   checkDataDescriptor  = 0x0100, 
<a name="l02832"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daca249fea9a22c531bd4b69a277097f33">02832</a>   checkVolumeEntries  = 0x0200, 
<a name="l02833"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da7ecd57be82b9d2a43d0ef3d720f8fca8">02833</a>   checkDecryptionVerifier = 0x0400, 
<a name="l02834"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da9263f24723fdc0985f274d84ee54b6f7">02834</a>   checkAll    = checkCRC | checkLocalAll | checkDataDescriptor | checkVolumeEntries | checkDecryptionVerifier, 
<a name="l02835"></a><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dabc39679fb833080779440a4a4b88d93f">02835</a>   checkIgnoredByDefault = checkDataDescriptor | checkVolumeEntries 
<a name="l02836"></a>02836  };
<a name="l02837"></a>02837 
<a name="l02844"></a><a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561">02844</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561">SpecialFlags</a>
<a name="l02845"></a>02845  {
<a name="l02846"></a>02846   sfNone,
<a name="l02855"></a><a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561a1c6105efbaf985ec970d338502f020cb">02855</a>   <a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561a1c6105efbaf985ec970d338502f020cb">sfExhaustiveRead</a>,
<a name="l02856"></a>02856  };
<a name="l02857"></a>02857 
<a name="l02870"></a><a class="code" href="classCZipArchive.html#a6c97370520628da3908d7dca9b58fdeb">02870</a>  <span class="keywordtype">void</span> SetIgnoredConsistencyChecks(<span class="keywordtype">int</span> iLevel = checkIgnoredByDefault)
<a name="l02871"></a>02871  {
<a name="l02872"></a>02872   <span class="keywordflow">if</span> (IsClosed())
<a name="l02873"></a>02873   {
<a name="l02874"></a>02874    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it after opening the archive.\n&quot;</span>);
<a name="l02875"></a>02875    <span class="keywordflow">return</span>;
<a name="l02876"></a>02876   }
<a name="l02877"></a>02877   m_centralDir.m_iIgnoredChecks = iLevel;
<a name="l02878"></a>02878  }
<a name="l02879"></a>02879  
<a name="l02886"></a><a class="code" href="classCZipArchive.html#a69d2178514e8d8e0a4f91b6bb1e5864e">02886</a>  <span class="keywordtype">int</span> GetIgnoredConsistencyChecks()<span class="keyword"> const</span>
<a name="l02887"></a>02887 <span class="keyword"> </span>{
<a name="l02888"></a>02888   <span class="keywordflow">return</span> m_centralDir.m_iIgnoredChecks;
<a name="l02889"></a>02889  }
<a name="l02890"></a>02890 
<a name="l02897"></a><a class="code" href="classCZipArchive.html#a996973569d480fba3627607dc7552db7">02897</a>  <span class="keywordtype">void</span> SetSpecialFlags(<span class="keywordtype">int</span> iSpecialFlags)
<a name="l02898"></a>02898  {
<a name="l02899"></a>02899   <span class="keywordflow">if</span> (!IsClosed())
<a name="l02900"></a>02900   {
<a name="l02901"></a>02901    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it before opening the archive.\n&quot;</span>);
<a name="l02902"></a>02902    <span class="keywordflow">return</span>;
<a name="l02903"></a>02903   }
<a name="l02904"></a>02904   m_centralDir.m_specialFlags = iSpecialFlags;
<a name="l02905"></a>02905  }
<a name="l02906"></a>02906 
<a name="l02913"></a><a class="code" href="classCZipArchive.html#ada64e986cf98b13789acc996af7d3a90">02913</a>  <span class="keywordtype">int</span> GetSpecialFlags()<span class="keyword"> const</span>
<a name="l02914"></a>02914 <span class="keyword"> </span>{
<a name="l02915"></a>02915   <span class="keywordflow">return</span> m_centralDir.m_specialFlags;
<a name="l02916"></a>02916  }
<a name="l02917"></a>02917 
<a name="l02944"></a>02944  <span class="keywordtype">void</span> FindMatches(LPCTSTR lpszPattern, CZipIndexesArray&amp; ar, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>);
<a name="l02945"></a>02945  
<a name="l02952"></a><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4">02952</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4">CommitMode</a>
<a name="l02953"></a>02953  {
<a name="l02954"></a><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4a1fc91e619248861ee0b182ed90bea791">02954</a>   <a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4a1fc91e619248861ee0b182ed90bea791" title="Changes will be committed when the CommitChanges method is called or when closing the archive...">cmManual</a>, 
<a name="l02955"></a><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4abb999d299acb20bd6995524b2c134be3">02955</a>   cmOnChange 
<a name="l02956"></a>02956  };
<a name="l02957"></a>02957 
<a name="l02971"></a><a class="code" href="classCZipArchive.html#a28f18c652496e2599bd49d0f0648769d">02971</a>  <span class="keywordtype">void</span> SetCommitMode(<span class="keywordtype">int</span> iCommitMode = cmOnChange) 
<a name="l02972"></a>02972  { 
<a name="l02973"></a>02973   m_iCommitMode = iCommitMode;
<a name="l02974"></a>02974  }
<a name="l02975"></a>02975 
<a name="l02989"></a><a class="code" href="classCZipArchive.html#a3adb7bec41b0cfb44871c297a85c592e">02989</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a3adb7bec41b0cfb44871c297a85c592e">GetCommitMode</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_iCommitMode;}
<a name="l02990"></a>02990 
<a name="l03012"></a>03012  <span class="keywordtype">bool</span> CommitChanges();
<a name="l03013"></a>03013 
<a name="l03025"></a><a class="code" href="classCZipArchive.html#a871adedb7077a464d52a2ab6ef36b4b7">03025</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a871adedb7077a464d52a2ab6ef36b4b7">IsModified</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_centralDir.IsAnyFileModified();}
<a name="l03026"></a>03026  
<a name="l03037"></a>03037  <span class="keywordtype">bool</span> RemoveCentralDirectoryFromArchive();
<a name="l03038"></a>03038 
<a name="l03054"></a>03054  <span class="keywordtype">bool</span> ReadLocalHeader(ZIP_INDEX_TYPE uIndex);
<a name="l03055"></a>03055 
<a name="l03071"></a>03071  <span class="keywordtype">bool</span> OverwriteLocalHeader(ZIP_INDEX_TYPE uIndex);
<a name="l03072"></a>03072 
<a name="l03080"></a><a class="code" href="classCZipArchive.html#a53b9a02f389496fc4707a39036fc560a">03080</a>  <span class="keyword">const</span> <a class="code" href="classCZipCompressor.html">CZipCompressor</a>* GetCurrentCompressor()<span class="keyword"> const</span>
<a name="l03081"></a>03081 <span class="keyword"> </span>{
<a name="l03082"></a>03082   <span class="keywordflow">return</span> m_pCompressor;
<a name="l03083"></a>03083  }
<a name="l03084"></a>03084 
<a name="l03097"></a><a class="code" href="classCZipArchive.html#a7bc5e2fdbda00dc96e237423e855af19">03097</a>  <span class="keywordtype">bool</span> CanModify(<span class="keywordtype">bool</span> bAllowNewSegmented = <span class="keyword">false</span>, <span class="keywordtype">bool</span> bNeedsClosed = <span class="keyword">true</span>)
<a name="l03098"></a>03098  {
<a name="l03099"></a>03099   <span class="keywordflow">if</span> (IsClosed())
<a name="l03100"></a>03100   {
<a name="l03101"></a>03101    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive is closed.\n&quot;</span>);
<a name="l03102"></a>03102    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03103"></a>03103   }
<a name="l03104"></a>03104 
<a name="l03105"></a>03105   <span class="keywordflow">if</span> (m_storage.IsReadOnly())
<a name="l03106"></a>03106   {
<a name="l03107"></a>03107    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03108"></a>03108   }
<a name="l03109"></a>03109   
<a name="l03110"></a>03110   <span class="keywordflow">if</span> (m_storage.IsNewSegmented() &amp;&amp; !bAllowNewSegmented)
<a name="l03111"></a>03111   {
<a name="l03112"></a>03112    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03113"></a>03113   }
<a name="l03114"></a>03114   
<a name="l03115"></a>03115   <span class="keywordflow">if</span> (bNeedsClosed &amp;&amp; m_iFileOpened)
<a name="l03116"></a>03116   {
<a name="l03117"></a>03117    ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : The file cannot be open during modifications.\n&quot;</span>);
<a name="l03118"></a>03118    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03119"></a>03119   }
<a name="l03120"></a>03120 
<a name="l03121"></a>03121   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03122"></a>03122  }
<a name="l03123"></a>03123 
<a name="l03124"></a>03124  <span class="keywordtype">bool</span> IsPasswordSet()<span class="keyword"> const</span>
<a name="l03125"></a>03125 <span class="keyword"> </span>{
<a name="l03126"></a>03126   <span class="keywordflow">return</span> m_pszPassword.GetSize() &gt; 0;
<a name="l03127"></a>03127  }
<a name="l03128"></a>03128 
<a name="l03129"></a>03129  
<a name="l03140"></a>03140  <span class="keywordtype">bool</span> ResetCurrentVolume();
<a name="l03141"></a>03141 
<a name="l03154"></a>03154  <span class="keyword">static</span> <span class="keywordtype">bool</span> IsZipArchive(LPCTSTR lpszPathName);
<a name="l03155"></a>03155 
<a name="l03171"></a>03171  <span class="keyword">static</span> <span class="keywordtype">bool</span> IsZipArchive(CZipAbstractFile&amp; af, <span class="keywordtype">bool</span> bAutoClose = <span class="keyword">false</span>);
<a name="l03172"></a>03172 
<a name="l03179"></a><a class="code" href="classCZipArchive.html#a940810c83896365f88e4be14809674c9">03179</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a940810c83896365f88e4be14809674c9">m_bRemoveDriveLetter</a>;
<a name="l03180"></a>03180  
<a name="l03181"></a>03181 <span class="keyword">protected</span>:
<a name="l03182"></a>03182  
<a name="l03190"></a><a class="code" href="classCZipArchive.html#ac93ea693b6cba8ceb429b73d3fad2ff5">03190</a>  <span class="keywordtype">void</span> ReadLocalHeaderInternal(ZIP_INDEX_TYPE uIndex)
<a name="l03191"></a>03191  {
<a name="l03192"></a>03192   <span class="comment">// update sizes of the local filename and the extra field - they may differ from the ones in the central directory</span>
<a name="l03193"></a>03193   GetFileInfo(uIndex)-&gt;ReadLocal(&amp;m_centralDir);
<a name="l03194"></a>03194  }
<a name="l03195"></a>03195 
<a name="l03208"></a>03208  <span class="keywordtype">bool</span> EncryptFilesInternal(CZipIndexesArray* pIndexes);
<a name="l03209"></a>03209 
<a name="l03210"></a>03210 
<a name="l03222"></a>03222  <span class="keywordtype">bool</span> OpenNewFile(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a> &amp; header, <span class="keywordtype">int</span> iLevel, LPCTSTR lpszFilePath, ZIP_INDEX_TYPE uReplaceIndex);
<a name="l03223"></a>03223  
<a name="l03227"></a><a class="code" href="classCZipArchive.html#aa795b1019332361e82b4f09d4c09f4a4">03227</a>  ZipArchiveLib::CZipCallbackProvider <a class="code" href="classCZipArchive.html#aa795b1019332361e82b4f09d4c09f4a4">m_callbacks</a>;
<a name="l03228"></a>03228  
<a name="l03229"></a>03229 
<a name="l03233"></a>03233  <span class="keywordtype">void</span> WriteCentralDirectory(<span class="keywordtype">bool</span> bFlush = <span class="keyword">true</span>);
<a name="l03234"></a>03234 
<a name="l03238"></a><a class="code" href="classCZipArchive.html#a63c15f0ac2da695bbf5b2abaaa1c63b9">03238</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a63c15f0ac2da695bbf5b2abaaa1c63b9">m_bCaseSensitive</a>;
<a name="l03239"></a>03239  
<a name="l03240"></a>03240 
<a name="l03245"></a><a class="code" href="classCZipArchive.html#a583ac1a566a2d990a633ed667da1c143">03245</a>  ZIPSTRINGCOMPARE <a class="code" href="classCZipArchive.html#a583ac1a566a2d990a633ed667da1c143">m_pZipCompare</a>;
<a name="l03246"></a>03246 
<a name="l03247"></a>03247 
<a name="l03253"></a><a class="code" href="classCZipArchive.html#a54baf3557f580c2db1577a3c3da98a2b">03253</a>  <a class="code" href="classCZipStorage.html">CZipStorage</a> <a class="code" href="classCZipArchive.html#a54baf3557f580c2db1577a3c3da98a2b">m_storage</a>;
<a name="l03254"></a>03254 
<a name="l03260"></a><a class="code" href="classCZipArchive.html#aee3ada39e4ec242778b433cfd887278e">03260</a>  <a class="code" href="classCZipCentralDir.html">CZipCentralDir</a> <a class="code" href="classCZipArchive.html#aee3ada39e4ec242778b433cfd887278e">m_centralDir</a>;
<a name="l03261"></a>03261 
<a name="l03265"></a><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671">03265</a>  <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671">OpenFileType</a>
<a name="l03266"></a>03266  {
<a name="l03267"></a><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671ad22f504670df3b8e7ceb8f7a37917378">03267</a>   extract = -1, 
<a name="l03268"></a><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671af4d8c9f91c22e297b77896ebdc52b239">03268</a>   <a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671af4d8c9f91c22e297b77896ebdc52b239" title="There is no file inside the archive opened.">nothing</a>,  
<a name="l03269"></a><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671a99445f88722247f1f8cbb185572a3542">03269</a>   compress  
<a name="l03270"></a>03270  };
<a name="l03271"></a>03271  
<a name="l03275"></a><a class="code" href="classCZipArchive.html#a798fcb7bc9984133999dbd1c6e6823e5">03275</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a798fcb7bc9984133999dbd1c6e6823e5">m_iFileOpened</a>;
<a name="l03276"></a>03276 
<a name="l03280"></a><a class="code" href="classCZipArchive.html#a53e452ea83aa5d8d611062880b57ba5a">03280</a>  <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a53e452ea83aa5d8d611062880b57ba5a">m_bAutoFinalize</a>;
<a name="l03281"></a>03281 
<a name="l03285"></a><a class="code" href="classCZipArchive.html#aa97444697499eb2c956744a7ac16f9e7">03285</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#aa97444697499eb2c956744a7ac16f9e7">m_iCommitMode</a>;
<a name="l03286"></a>03286 
<a name="l03290"></a><a class="code" href="classCZipArchive.html#aa1895d5447111f55159aed88fa1f1d4d">03290</a>  CZipString <a class="code" href="classCZipArchive.html#aa1895d5447111f55159aed88fa1f1d4d">m_szRootPath</a>;
<a name="l03291"></a>03291 
<a name="l03295"></a><a class="code" href="classCZipArchive.html#a0fe6e4697b6a9e7e6f52011c66621936">03295</a>  CZipString <a class="code" href="classCZipArchive.html#a0fe6e4697b6a9e7e6f52011c66621936">m_szTempPath</a>;
<a name="l03296"></a>03296 
<a name="l03297"></a>03297 
<a name="l03304"></a>03304  <span class="keywordtype">void</span> OpenInternal(<span class="keywordtype">int</span> iMode);
<a name="l03305"></a>03305 
<a name="l03316"></a>03316  <span class="keywordtype">void</span> InitOnOpen(<span class="keywordtype">int</span> iArchiveSystCompatib, <a class="code" href="classCZipCentralDir.html">CZipCentralDir</a>* pSource = NULL);
<a name="l03317"></a>03317 
<a name="l03321"></a><a class="code" href="classCZipArchive.html#a23a52208759f43b1efe57af59264a407">03321</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a23a52208759f43b1efe57af59264a407">m_iArchiveSystCompatib</a>;
<a name="l03322"></a>03322 
<a name="l03326"></a><a class="code" href="classCZipArchive.html#afd1df17f464a949ea40859bae5689e4a">03326</a>  CZipAutoBuffer <a class="code" href="classCZipArchive.html#afd1df17f464a949ea40859bae5689e4a">m_pszPassword</a>;
<a name="l03327"></a>03327 
<a name="l03333"></a>03333  <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* CurrentFile();
<a name="l03334"></a>03334 
<a name="l03338"></a><a class="code" href="classCZipArchive.html#ae8d24271cb186f4db02064d82c9f6655">03338</a>  <span class="keywordtype">void</span> ClearCryptograph()
<a name="l03339"></a>03339  {
<a name="l03340"></a>03340   <span class="keywordflow">if</span> (m_pCryptograph)
<a name="l03341"></a>03341   {
<a name="l03342"></a>03342    <span class="keyword">delete</span> m_pCryptograph;
<a name="l03343"></a>03343    m_pCryptograph = NULL;
<a name="l03344"></a>03344   }
<a name="l03345"></a>03345  }
<a name="l03346"></a>03346 
<a name="l03356"></a><a class="code" href="classCZipArchive.html#a008c35d0a4f148b88c5d2177ebab46ec">03356</a>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateCryptograph(<span class="keywordtype">int</span> iEncryptionMethod)
<a name="l03357"></a>03357  {
<a name="l03358"></a>03358   <span class="keywordflow">if</span> (m_pCryptograph != NULL)
<a name="l03359"></a>03359    <span class="keywordflow">if</span> (m_pCryptograph-&gt;CanHandle(iEncryptionMethod))
<a name="l03360"></a>03360     <span class="keywordflow">return</span>;
<a name="l03361"></a>03361 
<a name="l03362"></a>03362   ClearCryptograph();
<a name="l03363"></a>03363   m_pCryptograph = <a class="code" href="classCZipCryptograph.html#a67ea47605ae88bc06e0a07837505459e">CZipCryptograph::CreateCryptograph</a>(iEncryptionMethod);
<a name="l03364"></a>03364  }
<a name="l03365"></a>03365 
<a name="l03369"></a><a class="code" href="classCZipArchive.html#a8650f1fa6f5eb19665d451921b27abca">03369</a>  <a class="code" href="classCZipCryptograph.html">CZipCryptograph</a>* <a class="code" href="classCZipArchive.html#a8650f1fa6f5eb19665d451921b27abca">m_pCryptograph</a>;
<a name="l03370"></a>03370 
<a name="l03374"></a><a class="code" href="classCZipArchive.html#a9054cd040e9a2915898b291f68728c4e">03374</a>  <span class="keywordtype">void</span> ClearCompressor()
<a name="l03375"></a>03375  {
<a name="l03376"></a>03376   <span class="keywordflow">if</span> (m_pCompressor)
<a name="l03377"></a>03377   {
<a name="l03378"></a>03378    <span class="keyword">delete</span> m_pCompressor;
<a name="l03379"></a>03379    m_pCompressor = NULL;
<a name="l03380"></a>03380   }
<a name="l03381"></a>03381  }
<a name="l03382"></a>03382 
<a name="l03392"></a><a class="code" href="classCZipArchive.html#a5cf921a705ed1f79304880ba7c375660">03392</a>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateCompressor(WORD uMethod)
<a name="l03393"></a>03393  {
<a name="l03394"></a>03394   <span class="keywordflow">if</span> (m_pCompressor == NULL || !m_pCompressor-&gt;CanProcess(uMethod))
<a name="l03395"></a>03395   {
<a name="l03396"></a>03396    ClearCompressor();
<a name="l03397"></a>03397    m_pCompressor = <a class="code" href="classCZipCompressor.html#adb9fc500cbf2e53fba533e615d8e9b29">CZipCompressor::CreateCompressor</a>(uMethod, &amp;m_storage);
<a name="l03398"></a>03398   }
<a name="l03399"></a>03399   m_pCompressor-&gt;UpdateOptions(m_compressorsOptions);
<a name="l03400"></a>03400  }
<a name="l03401"></a>03401 
<a name="l03405"></a><a class="code" href="classCZipArchive.html#acb4fdfe54136a786dcf46c225bcdc93d">03405</a>  <a class="code" href="classCZipCompressor.html">CZipCompressor</a>* <a class="code" href="classCZipArchive.html#acb4fdfe54136a786dcf46c225bcdc93d">m_pCompressor</a>;
<a name="l03406"></a>03406 
<a name="l03410"></a><a class="code" href="classCZipArchive.html#a4982e7da972267e0cd5db1e5b41094eb">03410</a>  <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a4982e7da972267e0cd5db1e5b41094eb">m_iEncryptionMethod</a>;
<a name="l03411"></a>03411 
<a name="l03415"></a><a class="code" href="classCZipArchive.html#a135fd4a99a8befe6e7f38301e35e83a9">03415</a>  WORD <a class="code" href="classCZipArchive.html#a135fd4a99a8befe6e7f38301e35e83a9">m_uCompressionMethod</a>;
<a name="l03416"></a>03416  
<a name="l03417"></a>03417 
<a name="l03426"></a><a class="code" href="classCZipArchive.html#a2c10424365afc7d073e53bc1e120c410">03426</a>  CZipAutoBuffer <a class="code" href="classCZipArchive.html#a2c10424365afc7d073e53bc1e120c410">m_pBuffer</a>;
<a name="l03427"></a>03427 
<a name="l03436"></a><a class="code" href="classCZipArchive.html#aeb1fe32b8b4218244c88f0eb0d52688e">03436</a>  DWORD <a class="code" href="classCZipArchive.html#aeb1fe32b8b4218244c88f0eb0d52688e">m_iBufferSize</a>;
<a name="l03437"></a>03437 
<a name="l03438"></a>03438 <span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span>
<a name="l03439"></a>03439 <span class="preprocessor"></span>
<a name="l03442"></a><a class="code" href="classCZipArchive.html#ad0613d8a6210b68a6569b45140a2e9a6">03442</a>  <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a> <a class="code" href="classCZipArchive.html#ad0613d8a6210b68a6569b45140a2e9a6">m_stringSettings</a>;
<a name="l03443"></a>03443 <span class="preprocessor">#endif</span>
<a name="l03444"></a>03444 <span class="preprocessor"></span> 
<a name="l03445"></a>03445 <span class="keyword">private</span>:
<a name="l03446"></a>03446  <a class="code" href="classCZipCompressor_1_1COptionsMap.html">CZipCompressor::COptionsMap</a> m_compressorsOptions;
<a name="l03447"></a>03447  <span class="keywordtype">void</span> Initialize();
<a name="l03448"></a>03448  <span class="keywordtype">void</span> MakeSpaceForReplace(ZIP_INDEX_TYPE iReplaceIndex, ZIP_SIZE_TYPE uTotal, LPCTSTR lpszFileName);
<a name="l03449"></a>03449 
<a name="l03450"></a>03450  <span class="keywordtype">void</span> MovePackedFiles(ZIP_SIZE_TYPE uStartOffset, ZIP_SIZE_TYPE uEndOffset, ZIP_SIZE_TYPE uMoveBy, <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback, <span class="keywordtype">bool</span> bForward = <span class="keyword">false</span>, <span class="keywordtype">bool</span> bLastCall = <span class="keyword">true</span>);
<a name="l03451"></a>03451  
<a name="l03452"></a>03452  <span class="keywordtype">bool</span> RemoveLast(<span class="keywordtype">bool</span> bRemoveAnyway = <span class="keyword">false</span>);
<a name="l03453"></a>03453 
<a name="l03454"></a>03454  <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file.">CZipArchive</a>&amp; zip, ZIP_INDEX_TYPE uIndex, LPCTSTR lpszNewFileName, ZIP_INDEX_TYPE iReplaceIndex, <span class="keywordtype">bool</span> bKeepSystComp, <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback);
<a name="l03455"></a>03455 
<a name="l03456"></a>03456  <span class="keywordtype">bool</span> UpdateReplaceIndex(ZIP_INDEX_TYPE&amp; iReplaceIndex);
<a name="l03457"></a>03457  
<a name="l03458"></a>03458  <span class="keywordtype">void</span> ThrowError(<span class="keywordtype">int</span> err, LPCTSTR lpszFilePath = NULL) <span class="keyword">const</span>;  
<a name="l03459"></a>03459 
<a name="l03460"></a>03460  <span class="keywordtype">void</span> InitBuffer()
<a name="l03461"></a>03461  {
<a name="l03462"></a>03462   m_pBuffer.Allocate(m_iBufferSize);
<a name="l03463"></a>03463  }
<a name="l03464"></a>03464  <span class="keywordtype">void</span> ReleaseBuffer()
<a name="l03465"></a>03465  {
<a name="l03466"></a>03466   m_pBuffer.Release();
<a name="l03467"></a>03467  }
<a name="l03468"></a>03468 };
<a name="l03469"></a>03469 
<a name="l03470"></a>03470 <span class="preprocessor">#if (_MSC_VER &gt; 1000) &amp;&amp; (defined ZIP_HAS_DLL)</span>
<a name="l03471"></a>03471 <span class="preprocessor"></span><span class="preprocessor"> #pragma warning (pop)</span>
<a name="l03472"></a>03472 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l03473"></a>03473 <span class="preprocessor"></span>
<a name="l03474"></a>03474 <span class="preprocessor">#endif // !defined(ZIPARCHIVE_ZIPARCHIVE_DOT_H)</span>
</pre></div></div><!-- contents -->
<hr><address><small>
The ZipArchive Library Copyright &copy;&nbsp;2000 - 2012 Artpol Software - Tadeusz Dracz. Generated at Sun Mar 4 2012 00:18:52.
</small></address>
</body>
</html>
